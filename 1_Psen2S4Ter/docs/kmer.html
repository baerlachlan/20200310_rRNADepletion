<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lachlan Baer">

<title>rRNADepletion_s4ter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-474c6d7e63be50eb6972897072b39b27.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9f253fc715695556361a9d609d1163b1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-6957ea37afea8e4d348ff04dd501af60.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./kmer.html">k-mer</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">rRNADepletion_s4ter</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/baerlachlan/241107_THOC_Raman" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qc_rRNA_removed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC (rRNA removed)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./de.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DGE</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmer.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">k-mer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kappa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">kappa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./enrichment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">enrichment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ruv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RUV</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#k-mer-analysis" id="toc-k-mer-analysis" class="nav-link" data-scroll-target="#k-mer-analysis">k-mer analysis</a>
  <ul>
  <li><a href="#k-5" id="toc-k-5" class="nav-link" data-scroll-target="#k-5">k = 5</a>
  <ul>
  <li><a href="#counts" id="toc-counts" class="nav-link" data-scroll-target="#counts">Counts</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  <li><a href="#differential-expression" id="toc-differential-expression" class="nav-link" data-scroll-target="#differential-expression">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-6" id="toc-k-6" class="nav-link" data-scroll-target="#k-6">k = 6</a>
  <ul>
  <li><a href="#counts-1" id="toc-counts-1" class="nav-link" data-scroll-target="#counts-1">Counts</a></li>
  <li><a href="#properties-1" id="toc-properties-1" class="nav-link" data-scroll-target="#properties-1">Properties</a></li>
  <li><a href="#differential-expression-1" id="toc-differential-expression-1" class="nav-link" data-scroll-target="#differential-expression-1">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-7" id="toc-k-7" class="nav-link" data-scroll-target="#k-7">k = 7</a>
  <ul>
  <li><a href="#counts-2" id="toc-counts-2" class="nav-link" data-scroll-target="#counts-2">Counts</a></li>
  <li><a href="#properties-2" id="toc-properties-2" class="nav-link" data-scroll-target="#properties-2">Properties</a></li>
  <li><a href="#differential-expression-2" id="toc-differential-expression-2" class="nav-link" data-scroll-target="#differential-expression-2">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-8" id="toc-k-8" class="nav-link" data-scroll-target="#k-8">k = 8</a>
  <ul>
  <li><a href="#counts-3" id="toc-counts-3" class="nav-link" data-scroll-target="#counts-3">Counts</a></li>
  <li><a href="#properties-3" id="toc-properties-3" class="nav-link" data-scroll-target="#properties-3">Properties</a></li>
  <li><a href="#differential-expression-3" id="toc-differential-expression-3" class="nav-link" data-scroll-target="#differential-expression-3">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-9" id="toc-k-9" class="nav-link" data-scroll-target="#k-9">k = 9</a>
  <ul>
  <li><a href="#counts-4" id="toc-counts-4" class="nav-link" data-scroll-target="#counts-4">Counts</a></li>
  <li><a href="#properties-4" id="toc-properties-4" class="nav-link" data-scroll-target="#properties-4">Properties</a></li>
  <li><a href="#differential-expression-4" id="toc-differential-expression-4" class="nav-link" data-scroll-target="#differential-expression-4">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-10" id="toc-k-10" class="nav-link" data-scroll-target="#k-10">k = 10</a>
  <ul>
  <li><a href="#counts-5" id="toc-counts-5" class="nav-link" data-scroll-target="#counts-5">Counts</a></li>
  <li><a href="#properties-5" id="toc-properties-5" class="nav-link" data-scroll-target="#properties-5">Properties</a></li>
  <li><a href="#differential-expression-5" id="toc-differential-expression-5" class="nav-link" data-scroll-target="#differential-expression-5">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-11" id="toc-k-11" class="nav-link" data-scroll-target="#k-11">k = 11</a>
  <ul>
  <li><a href="#counts-6" id="toc-counts-6" class="nav-link" data-scroll-target="#counts-6">Counts</a></li>
  <li><a href="#properties-6" id="toc-properties-6" class="nav-link" data-scroll-target="#properties-6">Properties</a></li>
  <li><a href="#differential-expression-6" id="toc-differential-expression-6" class="nav-link" data-scroll-target="#differential-expression-6">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-12" id="toc-k-12" class="nav-link" data-scroll-target="#k-12">k = 12</a>
  <ul>
  <li><a href="#counts-7" id="toc-counts-7" class="nav-link" data-scroll-target="#counts-7">Counts</a></li>
  <li><a href="#properties-7" id="toc-properties-7" class="nav-link" data-scroll-target="#properties-7">Properties</a></li>
  <li><a href="#differential-expression-7" id="toc-differential-expression-7" class="nav-link" data-scroll-target="#differential-expression-7">Differential expression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#distributions" id="toc-distributions" class="nav-link" data-scroll-target="#distributions">Distributions</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#differential-expression-8" id="toc-differential-expression-8" class="nav-link" data-scroll-target="#differential-expression-8">Differential expression</a>
  <ul>
  <li><a href="#k-5-1" id="toc-k-5-1" class="nav-link" data-scroll-target="#k-5-1">k = 5</a></li>
  <li><a href="#k-6-1" id="toc-k-6-1" class="nav-link" data-scroll-target="#k-6-1">k = 6</a></li>
  <li><a href="#k-7-1" id="toc-k-7-1" class="nav-link" data-scroll-target="#k-7-1">k = 7</a></li>
  <li><a href="#k-8-1" id="toc-k-8-1" class="nav-link" data-scroll-target="#k-8-1">k = 8</a></li>
  <li><a href="#k-9-1" id="toc-k-9-1" class="nav-link" data-scroll-target="#k-9-1">k = 9</a></li>
  <li><a href="#k-10-1" id="toc-k-10-1" class="nav-link" data-scroll-target="#k-10-1">k = 10</a></li>
  <li><a href="#k-11-1" id="toc-k-11-1" class="nav-link" data-scroll-target="#k-11-1">k = 11</a></li>
  <li><a href="#k-12-1" id="toc-k-12-1" class="nav-link" data-scroll-target="#k-12-1">k = 12</a></li>
  </ul></li>
  <li><a href="#data-export" id="toc-data-export" class="nav-link" data-scroll-target="#data-export">Data export</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">rRNADepletion_s4ter</h1>
<p class="subtitle lead">k-mer analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lachlan Baer </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">LAST MODIFIED</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">08 May, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgeR)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>()) <span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>())</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     here::here("1_Psen2S4Ter/R/output/1_1_DE.RData")</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level1">
<h1>Load data</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>addInfo <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/addInfo.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-mer-analysis" class="level1">
<h1>k-mer analysis</h1>
<p><code>jellyfish v2.3.0</code> was used to count kmers of trimmed <code>fastq</code> files that had been filtered for rRNA sequences. This was performed for 5 values: <span class="math inline">\(k = 5, 6, 7, 8, 9, 10\)</span>. Lower values of <span class="math inline">\(k\)</span> lose specificity in comparison to higher values, however as <span class="math inline">\(k\)</span> increases, the exponential increase of possible kmers causes limitations due to computational processing time.</p>
<section id="k-5" class="level2">
<h2 class="anchored" data-anchor-id="k-5">k = 5</h2>
<section id="counts" class="level3">
<h3 class="anchored" data-anchor-id="counts">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>k5files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k5"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>k5counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k5files, <span class="cf">function</span>(x){</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>k5dge <span class="ot">&lt;-</span> k5counts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>k5dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>k5dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k5dge) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties" class="level3">
<h3 class="anchored" data-anchor-id="properties">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>k5dist <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 5-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>k5labels <span class="ot">&lt;-</span> k5dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>k5heat <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"5-mer counts heatmap"</span>, <span class="at">labels_row =</span> k5labels)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>k5heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k5labels</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>k5den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k5heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 5-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>k5pca <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>k5pcaPlot <span class="ot">&lt;-</span> k5pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k5dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 5"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>k5pcaRrna <span class="ot">&lt;-</span> k5pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k5dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 5"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>k5design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k5dge<span class="sc">$</span>samples)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>k5disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k5dge, k5design)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>k5fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k5disp)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k5fit) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-6" class="level2">
<h2 class="anchored" data-anchor-id="k-6">k = 6</h2>
<section id="counts-1" class="level3">
<h3 class="anchored" data-anchor-id="counts-1">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>k6files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k6"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>k6counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k6files, <span class="cf">function</span>(x){</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>k6dge <span class="ot">&lt;-</span> k6counts <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>k6dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>k6dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k6dge) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-1" class="level3">
<h3 class="anchored" data-anchor-id="properties-1">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>k6dist <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 6-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>k6labels <span class="ot">&lt;-</span> k6dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>k6heat <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"6-mer counts heatmap"</span>, <span class="at">labels_row =</span> k6labels)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>k6heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k6labels</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>k6den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k6heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 6-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>k6pca <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>k6pcaPlot <span class="ot">&lt;-</span> k6pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k6dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 6"</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k6pcaRrna <span class="ot">&lt;-</span> k6pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k6dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 6"</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-1" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-1">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>k6design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k6dge<span class="sc">$</span>samples)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>k6disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k6dge, k6design)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>k6fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k6disp)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k6fit) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-7" class="level2">
<h2 class="anchored" data-anchor-id="k-7">k = 7</h2>
<section id="counts-2" class="level3">
<h3 class="anchored" data-anchor-id="counts-2">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k7files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k7"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>k7counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k7files, <span class="cf">function</span>(x){</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>k7dge <span class="ot">&lt;-</span> k7counts <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>k7dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>k7dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k7dge) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-2" class="level3">
<h3 class="anchored" data-anchor-id="properties-2">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>k7dist <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 7-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>k7labels <span class="ot">&lt;-</span> k7dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>k7heat <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"7-mer counts heatmap"</span>, <span class="at">labels_row =</span> k7labels)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>k7heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k7labels</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>k7den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k7heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 7-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k7pca <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>k7pcaPlot <span class="ot">&lt;-</span> k7pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k7dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 7"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>k7pcaRrna <span class="ot">&lt;-</span> k7pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k7dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 7"</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-2" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-2">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>k7design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k7dge<span class="sc">$</span>samples)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>k7disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k7dge, k7design)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>k7fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k7disp)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k7fit) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-8" class="level2">
<h2 class="anchored" data-anchor-id="k-8">k = 8</h2>
<section id="counts-3" class="level3">
<h3 class="anchored" data-anchor-id="counts-3">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>k8files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k8"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>k8counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k8files, <span class="cf">function</span>(x){</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>k8dge <span class="ot">&lt;-</span> k8counts <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>k8dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>k8dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k8dge) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-3" class="level3">
<h3 class="anchored" data-anchor-id="properties-3">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>k8dist <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 8-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>k8labels <span class="ot">&lt;-</span> k8dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>k8heat <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"8-mer counts heatmap"</span>, <span class="at">labels_row =</span> k8labels)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>k8heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k8labels</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>k8den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k8heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 8-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>k8pca <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>k8pcaPlot <span class="ot">&lt;-</span> k8pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k8dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 8"</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>k8pcaRrna <span class="ot">&lt;-</span> k8pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k8dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 8"</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-3" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-3">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k8design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k8dge<span class="sc">$</span>samples)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>k8disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k8dge, k8design)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>k8fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k8disp)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k8fit) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-9" class="level2">
<h2 class="anchored" data-anchor-id="k-9">k = 9</h2>
<section id="counts-4" class="level3">
<h3 class="anchored" data-anchor-id="counts-4">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>k9files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k9"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>k9counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k9files, <span class="cf">function</span>(x){</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>k9dge <span class="ot">&lt;-</span> k9counts <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>k9dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>k9dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k9dge) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-4" class="level3">
<h3 class="anchored" data-anchor-id="properties-4">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>k9dist <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 9-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>k9labels <span class="ot">&lt;-</span> k9dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>k9heat <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"9-mer counts heatmap"</span>, <span class="at">labels_row =</span> k9labels)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>k9heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k9labels</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>k9den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k9heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 9-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>k9pca <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>k9pcaPlot <span class="ot">&lt;-</span> k9pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k9dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 9"</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>k9pcaRrna <span class="ot">&lt;-</span> k9pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k9dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 9"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-4" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-4">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>k9design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k9dge<span class="sc">$</span>samples)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>k9disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k9dge, k9design)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>k9fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k9disp)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k9fit) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-10" class="level2">
<h2 class="anchored" data-anchor-id="k-10">k = 10</h2>
<section id="counts-5" class="level3">
<h3 class="anchored" data-anchor-id="counts-5">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>k10files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k10"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>k10counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k10files, <span class="cf">function</span>(x){</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>k10dge <span class="ot">&lt;-</span> k10counts <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>k10dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>k10dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k10dge) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-5" class="level3">
<h3 class="anchored" data-anchor-id="properties-5">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k10dist &lt;- k10dge %&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_longer(everything(), names_to = "sample", values_to = "count") %&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(x=count, colour = sample)) +</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_density() +</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(x = "intensity", title = "Distribution of 10-mers")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k10labels &lt;- k10dge$samples %&gt;% </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(label = paste0(sample, "\n", percent(rRNA, accuracy = 0.01), " rRNA")) %&gt;% </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     .$label</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># k10heat &lt;- k10dge %&gt;% </span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     t() %&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     pheatmap(silent = TRUE, cluster_cols = FALSE,</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              show_colnames = FALSE, fontsize = 9,</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fontsize_row = 10, border_color = NA,</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              main = "10-mer counts heatmap", labels_row = k10labels)</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># k10heat$tree_row$labels &lt;- k10labels</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># k10den &lt;- ggdendrogram(k10heat$tree_row, rotate = TRUE) +</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(title = "Hierarchical clustering of 10-mer counts") +</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(plot.title = element_text(size = 12))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>k10pca <span class="ot">&lt;-</span> k10dge <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>k10pcaPlot <span class="ot">&lt;-</span> k10pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k10dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 10"</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k10pcaRrna &lt;- k10pca$x %&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     rownames_to_column("sample") %&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     as_tibble() %&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::select(sample, PC1, PC2) %&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     left_join(k10dge$samples) %&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(PC1, rRNA, label = rRNA)) +</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(aes(colour = group), alpha = 0.8, size = 3) +</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_text_repel(show.legend = FALSE) +</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_smooth(method = "lm") +</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         x = paste0("PC1 (", percent(summary(k10pca)$importance[2, "PC1"]), ")"),</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co">#         y = "rRNA proportion",</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         colour = "Genotype",</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="co">#         title = "k = 10"</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) +</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(labels = percent) +</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_discrete(labels = c("Wildtype", "Heterozygous", "Homozygous"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-5" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-5">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>k10design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k10dge<span class="sc">$</span>samples)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>k10disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k10dge, k10design)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>k10fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k10disp)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k10fit) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-11" class="level2">
<h2 class="anchored" data-anchor-id="k-11">k = 11</h2>
<section id="counts-6" class="level3">
<h3 class="anchored" data-anchor-id="counts-6">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>k11files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k11"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>k11counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k11files, <span class="cf">function</span>(x){</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>k11dge <span class="ot">&lt;-</span> k11counts <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>k11dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>k11dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k11dge) <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-6" class="level3">
<h3 class="anchored" data-anchor-id="properties-6">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k11dist &lt;- k11dge %&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_longer(everything(), names_to = "sample", values_to = "count") %&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(x=count, colour = sample)) +</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_density() +</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(x = "intensity", title = "Distribution of 11-mers")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k11labels &lt;- k11dge$samples %&gt;% </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(label = paste0(sample, "\n", percent(rRNA, accuracy = 0.01), " rRNA")) %&gt;% </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     .$label</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># k11heat &lt;- k11dge %&gt;% </span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     t() %&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     pheatmap(silent = TRUE, cluster_cols = FALSE,</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              show_colnames = FALSE, fontsize = 9,</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fontsize_row = 10, border_color = NA,</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              main = "11-mer counts heatmap", labels_row = k11labels)</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="co"># k11heat$tree_row$labels &lt;- k11labels</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># k11den &lt;- ggdendrogram(k11heat$tree_row, rotate = TRUE) +</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(title = "Hierarchical clustering of 11-mer counts") +</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(plot.title = element_text(size = 12))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>k11pca <span class="ot">&lt;-</span> k11dge <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>k11pcaPlot <span class="ot">&lt;-</span> k11pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k11dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 11"</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k11pcaRrna &lt;- k11pca$x %&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     rownames_to_column("sample") %&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     as_tibble() %&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::select(sample, PC1, PC2) %&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     left_join(k11dge$samples) %&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(PC1, rRNA, label = rRNA)) +</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(aes(colour = group), alpha = 0.8, size = 3) +</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_text_repel(show.legend = FALSE) +</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_smooth(method = "lm") +</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         x = paste0("PC1 (", percent(summary(k11pca)$importance[2, "PC1"]), ")"),</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">#         y = "rRNA proportion",</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         colour = "Genotype",</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co">#         title = "k = 11"</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) +</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(labels = percent) +</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_discrete(labels = c("Wildtype", "Heterozygous", "Homozygous"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-6" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-6">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>k11design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k11dge<span class="sc">$</span>samples)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>k11disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k11dge, k11design)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>k11fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k11disp)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k11fit) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-12" class="level2">
<h2 class="anchored" data-anchor-id="k-12">k = 12</h2>
<section id="counts-7" class="level3">
<h3 class="anchored" data-anchor-id="counts-7">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>k12files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/phoenix/gpfs/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k12"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>k12counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k12files, <span class="cf">function</span>(x){</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(mer, contains(c("WT", "Heter")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>k12dge <span class="ot">&lt;-</span> k12counts <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>k12dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>k12dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k12dge) <span class="sc">%&gt;%</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter|Hom)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>, <span class="st">"Hom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-7" class="level3">
<h3 class="anchored" data-anchor-id="properties-7">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k12dist &lt;- k12dge %&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_longer(everything(), names_to = "sample", values_to = "count") %&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(x=count, colour = sample)) +</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_density() +</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(x = "intensity", title = "Distribution of 12-mers")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k12labels &lt;- k12dge$samples %&gt;% </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(label = paste0(sample, "\n", percent(rRNA, accuracy = 0.01), " rRNA")) %&gt;% </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     .$label</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># k12heat &lt;- k12dge %&gt;% </span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     cpm(log = TRUE) %&gt;%</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     t() %&gt;%</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     pheatmap(silent = TRUE, cluster_cols = FALSE,</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co">#              show_colnames = FALSE, fontsize = 9,</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fontsize_row = 10, border_color = NA,</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co">#              main = "12-mer counts heatmap", labels_row = k12labels)</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="co"># k12heat$tree_row$labels &lt;- k12labels</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># k12den &lt;- ggdendrogram(k12heat$tree_row, rotate = TRUE) +</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(title = "Hierarchical clustering of 12-mer counts") +</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(plot.title = element_text(size = 12))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>k12pca <span class="ot">&lt;-</span> k12dge <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>k12pcaPlot <span class="ot">&lt;-</span> k12pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k12dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 12"</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Heterozygous"</span>, <span class="st">"Homozygous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k12pcaRrna &lt;- k12pca$x %&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     as.data.frame() %&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     rownames_to_column("sample") %&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     as_tibble() %&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     dplyr::select(sample, PC1, PC2) %&gt;%</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     left_join(k12dge$samples) %&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     ggplot(aes(PC1, rRNA, label = rRNA)) +</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_point(aes(colour = group), alpha = 0.8, size = 3) +</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_text_repel(show.legend = FALSE) +</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_smooth(method = "lm") +</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         x = paste0("PC1 (", percent(summary(k12pca)$importance[2, "PC1"]), ")"),</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co">#         y = "rRNA proportion",</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         colour = "Genotype",</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co">#         title = "k = 12"</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) +</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_y_continuous(labels = percent) +</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     scale_colour_discrete(labels = c("Wildtype", "Heterozygous", "Homozygous"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-7" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-7">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>k12design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k12dge<span class="sc">$</span>samples)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>k12disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k12dge, k12design)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>k12fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k12disp)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k12fit) <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="distributions" class="level1">
<h1>Distributions</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     k5dist, k6dist, k7dist, k8dist, k9dist, k10dist, k11dist, k12dist,</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     ncol = 2, nrow = 4, common.legend = TRUE, legend = "bottom" </span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pca" class="level1">
<h1>PCA</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    k5pcaPlot, k6pcaPlot, k7pcaPlot, k8pcaPlot, k9pcaPlot, k10pcaPlot, k11pcaPlot, k12pcaPlot,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/allPcas-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Principal component analysis for all values of <span class="math inline">\(k\)</span>. As <span class="math inline">\(k\)</span> increases, WT and mutant groups start to separate.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     k5pcaRrna, k6pcaRrna, k7pcaRrna, k8pcaRrna, k9pcaRrna, k10pcaRrna, k11pcaRrna, k12pcaRrna,</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     ncol = 2, nrow = 4, common.legend = TRUE, legend = "bottom"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="clustering" class="level1">
<h1>Clustering</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggarrange(</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     k5den, k6den, k7den, k8den, k9den, k10den, k11den, k12den,</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     ncol = 2, nrow = 4, common.legend = TRUE, legend = "bottom"</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-8" class="level1">
<h1>Differential expression</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>topRes <span class="ot">&lt;-</span> <span class="cf">function</span>(x, cap){</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(mer, logCPM, logFC, P.Value, FDR, BY, DE) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">logCPM =</span> <span class="fu">format</span>(<span class="fu">round</span>(logCPM, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">logFC =</span> <span class="fu">format</span>(<span class="fu">round</span>(logFC, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">P.Value =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, P.Value),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">FDR =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, FDR),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">BY =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, BY)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">datatable</span>(</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>),</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">class =</span> <span class="st">"striped hover condensed responsive"</span>,</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">caption =</span> cap</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="k-5-1" class="level2">
<h2 class="anchored" data-anchor-id="k-5-1">k = 5</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k5topTable,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 5-mers."</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k5topTable, DE)),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k5topTable),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with BY p-value &lt; 0.05."</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-71366475c13db6f4b82c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-71366475c13db6f4b82c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 5-mers. 158 of 512 detected sequences were classified as DE with BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["AGAGA","GAGAA","CAGCA","CCAAC","CATCC","GTCAA","ATGGA","CACAC","CAACC","ATGGG","AAGAG","GATGA","CCATC","CTGAC","AGATG","ATCCA","GCAAC","CTCTC","AGGAA","GGATA","GACTC","ACGCA","CTGGA","ACACA","GTCTA","CACTA","CCTTA","AGATC","GACCA","GTGAA","CACTC","AGGAT","GTTCA","AGTAG","AGGCA","CATCA","CAGTA","CTTGA","CAGTC","AGCTG","ATGAG","ACTCC","CAGAC","ACCCA","CTGTC","GAAGA","CAGAG","GCCAA","GCATA","ACTAC","AAGGG","GCAGA","GCCAC","GACTA","AGAGC","TACCA","GATGC","AGGGC","TCCAA","GGCCA","CTAAG","ATACC","CCACA","ACCAT","ACGCT","CTTGC","CTGCC","ACTCT","CTTCA","CTTCC","CCATA","ACTGG","ACAGA","AAGAC","CGTCA","AGAGG","GCACA","GTAGA","TCTCA","GAAGC","GATAC","GAGGA","AGAAG","TCTAA","ATTCC","AGACC","AGGTC","CTTTC","ATCAC","ACAAC","AGTGC","GATCA","TGCCA","ATATC","AGGTG","CGTTC","GAATA","ATCGG","GCGTA","CGATC"],["11.77","11.61","11.93","10.77","11.18","11.08","11.32","11.99","10.70","10.62","11.59","11.64","11.19","11.00","11.50","11.31","10.51","11.58","11.51","10.17","10.49","10.07","11.63","12.28","10.46","10.82","10.33","10.99","10.78","11.55","10.90","10.89","11.31","10.59","10.74","11.76","11.12","11.06","11.06","11.63","11.26","10.64","11.38","10.80","11.26","11.86","11.71","10.81","10.50","10.76","10.60","11.55","10.69","10.33","11.27","10.64","10.85","10.39","11.27","10.70","10.19","10.06","11.42","10.98"," 9.93","10.56","10.97","10.97","11.78","11.15","10.58","11.01","11.74","11.09","10.23","11.45","11.14","10.45","11.28","11.05","10.07","11.87","11.81","10.75","10.79","10.64","10.92","11.38","10.99","11.18","10.99","11.17","11.00","10.70","11.00"," 9.90","11.01","10.12"," 9.08","10.20"],["-1.54","-1.45","-1.48","-1.34","-1.86"," 1.16","-1.24","-2.37","-1.29","-0.97","-1.11","-1.13","-1.64","-0.92","-0.85","-1.04","-0.99","-1.50","-0.98","-1.23","-1.19","-1.21","-1.25","-1.61"," 2.33"," 1.70"," 1.33","-0.87","-0.85"," 0.98","-1.09","-0.88"," 0.75"," 1.60","-0.75","-0.74"," 0.96"," 0.81","-0.80","-0.76","-0.81","-1.09","-1.00","-0.91","-0.93","-1.32","-1.05","-0.77"," 1.41"," 2.18","-0.75","-0.93","-0.93"," 2.22","-1.06"," 1.70","-0.73","-0.97"," 1.04","-0.95"," 2.58"," 1.47","-0.75"," 0.73","-0.93","-0.77","-0.91","-0.73","-0.57","-1.24"," 0.68","-0.64","-0.82","-0.59","-0.82","-1.11","-0.89","-0.80","-0.60","-0.74"," 1.07","-1.46","-1.08"," 1.55"," 0.71","-0.74"," 2.98","-0.74","-0.71","-0.74"," 1.43"," 1.21","-0.63"," 1.24","-0.60","-0.84"," 1.23"," 3.87","-1.35"," 6.30"],["5.77e-09","1.65e-08","2.12e-08","6.00e-08","6.82e-08","7.25e-08","7.56e-08","1.07e-07","1.52e-07","1.78e-07","1.93e-07","2.73e-07","2.92e-07","3.25e-07","3.27e-07","3.42e-07","4.00e-07","4.22e-07","5.46e-07","5.79e-07","5.86e-07","6.22e-07","8.55e-07","9.64e-07","1.00e-06","1.06e-06","1.09e-06","1.11e-06","1.14e-06","1.25e-06","1.25e-06","1.27e-06","1.34e-06","1.40e-06","1.40e-06","1.54e-06","1.55e-06","2.06e-06","2.26e-06","2.34e-06","2.46e-06","2.46e-06","2.84e-06","3.07e-06","3.61e-06","3.66e-06","3.81e-06","4.26e-06","4.26e-06","4.27e-06","4.39e-06","4.86e-06","5.45e-06","5.54e-06","6.03e-06","6.96e-06","7.44e-06","7.56e-06","7.58e-06","7.79e-06","1.09e-05","1.14e-05","1.28e-05","1.30e-05","1.49e-05","1.64e-05","1.77e-05","2.24e-05","2.39e-05","2.50e-05","2.72e-05","2.93e-05","2.93e-05","2.95e-05","3.51e-05","3.70e-05","4.21e-05","4.21e-05","4.56e-05","4.57e-05","4.61e-05","4.82e-05","5.06e-05","5.19e-05","5.22e-05","5.39e-05","5.82e-05","5.88e-05","6.76e-05","6.80e-05","7.02e-05","7.46e-05","7.55e-05","8.42e-05","8.81e-05","9.38e-05","9.74e-05","9.90e-05","1.06e-04","1.24e-04"],["2.95e-06","3.62e-06","3.62e-06","5.53e-06","5.53e-06","5.53e-06","5.53e-06","6.86e-06","8.67e-06","8.99e-06","8.99e-06","1.09e-05","1.09e-05","1.09e-05","1.09e-05","1.09e-05","1.20e-05","1.20e-05","1.43e-05","1.43e-05","1.43e-05","1.45e-05","1.90e-05","2.00e-05","2.00e-05","2.00e-05","2.00e-05","2.00e-05","2.00e-05","2.03e-05","2.03e-05","2.03e-05","2.05e-05","2.05e-05","2.05e-05","2.14e-05","2.14e-05","2.77e-05","2.96e-05","3.00e-05","3.00e-05","3.00e-05","3.38e-05","3.57e-05","4.08e-05","4.08e-05","4.15e-05","4.37e-05","4.37e-05","4.37e-05","4.41e-05","4.79e-05","5.26e-05","5.26e-05","5.62e-05","6.36e-05","6.58e-05","6.58e-05","6.58e-05","6.65e-05","9.14e-05","9.44e-05","1.04e-04","1.04e-04","1.18e-04","1.27e-04","1.35e-04","1.69e-04","1.78e-04","1.83e-04","1.96e-04","2.04e-04","2.04e-04","2.04e-04","2.40e-04","2.49e-04","2.76e-04","2.76e-04","2.91e-04","2.91e-04","2.91e-04","3.01e-04","3.12e-04","3.15e-04","3.15e-04","3.21e-04","3.42e-04","3.42e-04","3.87e-04","3.87e-04","3.95e-04","4.15e-04","4.16e-04","4.59e-04","4.75e-04","5.00e-04","5.14e-04","5.17e-04","5.46e-04","6.33e-04"],["2.01e-05","2.47e-05","2.47e-05","3.77e-05","3.77e-05","3.77e-05","3.77e-05","4.68e-05","5.91e-05","6.13e-05","6.13e-05","7.45e-05","7.45e-05","7.45e-05","7.45e-05","7.45e-05","8.18e-05","8.18e-05","9.74e-05","9.74e-05","9.74e-05","9.87e-05","1.30e-04","1.37e-04","1.37e-04","1.37e-04","1.37e-04","1.37e-04","1.37e-04","1.38e-04","1.38e-04","1.38e-04","1.40e-04","1.40e-04","1.40e-04","1.46e-04","1.46e-04","1.89e-04","2.02e-04","2.04e-04","2.05e-04","2.05e-04","2.31e-04","2.43e-04","2.78e-04","2.78e-04","2.83e-04","2.98e-04","2.98e-04","2.98e-04","3.01e-04","3.26e-04","3.58e-04","3.58e-04","3.83e-04","4.34e-04","4.49e-04","4.49e-04","4.49e-04","4.53e-04","6.23e-04","6.43e-04","7.08e-04","7.08e-04","8.01e-04","8.69e-04","9.23e-04","1.15e-03","1.21e-03","1.25e-03","1.34e-03","1.39e-03","1.39e-03","1.39e-03","1.63e-03","1.70e-03","1.88e-03","1.88e-03","1.98e-03","1.98e-03","1.98e-03","2.05e-03","2.13e-03","2.14e-03","2.14e-03","2.19e-03","2.33e-03","2.33e-03","2.64e-03","2.64e-03","2.69e-03","2.83e-03","2.83e-03","3.13e-03","3.24e-03","3.41e-03","3.50e-03","3.53e-03","3.72e-03","4.32e-03"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>            <span class="co"># dplyr::filter(-log10(P.Value) &gt; 4 | logFC &gt; 4 | logFC &lt; -2),</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">2.5</span>),</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 5"</span>) <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-6-1" class="level2">
<h2 class="anchored" data-anchor-id="k-6-1">k = 6</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k6topTable,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 6-mers."</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k6topTable, DE)),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k6topTable),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a4ef03161f3c0b0ea34a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a4ef03161f3c0b0ea34a">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 6-mers. 662 of 2080 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["GTATTA","GTCAAA","GTAATA","AATAGA","ATACAG","AGTAAT","TATTCA","CATAGC","GTCTAA","ACTACT","ATTTGG","AAGCTA","AGATCT","TACTGA","AATTCC","AATACA","ACTGAT","AATTCG","GGATAA","GAGTAA","TACTCA","GGATTA","AACTTA","ACCATA","ACTTAG","GAATTC","ATCAGG","ATCGCG","CTTTGA","CAAATG","CCATAC","GGACAA","ACTATG","AGTGCA","AAGAGA","TATCCA","GCATAA","GTGCAA","ACAGCA","CTATTC","CACTAA","GAGCTA","ATATGG","CTACAG","CGCGCC","TCGAAA","TGATCA","ATATCG","AGGTCG","GCAACC","CTTGTC","ATCAAG","AGAGAA","GAAAGA","AATCCA","ACCCAT","GAGAAA","GTTCTA","TAGACA","CCTTAG","ATCCAA","GATCAA","CCGATC","ACCTAC","CAGTAG","GCAGAA","TATCGA","TCAAGA","CATATC","GTGAAC","GATTAC","GACTGA","ATAGTC","CCATTC","AAAGCC","CATTGC","CAGGGA","ACGTCA","ATTGCA","CTATAC","ACAGAC","ATACCG","ATAGAC","AACGTA","AACCCA","ACTAAG","AGATTC","AACCAG","AGGCAG","AATCTC","AATTTC","ATCGGC","AAACGT","AAAGAG","ACTGAG","ATCTAC","ATCCAC","GCGCGA","ACCAAC","CAACCA"],[" 8.94"," 9.72"," 9.17"," 9.30"," 9.61"," 9.24"," 9.69"," 8.10"," 8.89"," 9.01"," 9.36"," 8.77"," 8.29"," 9.33"," 8.78"," 9.85"," 9.59"," 8.02"," 8.64"," 8.92"," 8.81"," 8.67"," 9.12"," 8.91"," 8.26"," 7.84"," 9.01"," 7.91"," 9.74"," 9.83"," 8.34"," 8.99"," 8.86"," 9.63"," 9.83"," 8.86"," 8.74"," 9.02","10.12"," 8.96"," 9.13"," 8.15"," 9.06"," 9.22"," 8.19"," 8.02"," 8.54"," 8.37"," 9.09"," 8.37"," 8.84"," 9.18"," 9.98"," 9.91"," 9.43"," 8.58","10.11"," 8.13"," 9.07"," 8.41"," 9.26"," 9.24"," 9.16"," 7.96"," 9.31"," 9.68"," 8.79"," 9.34"," 8.96"," 9.45"," 8.42"," 9.29"," 8.55"," 9.04"," 9.57"," 8.94"," 8.93"," 8.35"," 9.28"," 8.13"," 9.66"," 8.00"," 8.81"," 7.74"," 9.14"," 8.51"," 8.98"," 9.24"," 9.13"," 9.18"," 9.40"," 8.90"," 8.63","10.07"," 9.18"," 8.50"," 9.16"," 8.13"," 8.93"," 9.14"],[" 4.14"," 2.90"," 3.99"," 3.23"," 2.38"," 3.05"," 2.58","-1.52"," 4.91"," 3.79"," 2.03"," 2.19","-1.58"," 2.97"," 2.40"," 2.61"," 2.63"," 4.17","-1.57"," 3.03"," 3.23"," 1.74"," 2.91"," 3.66"," 4.81"," 4.16","-0.97"," 7.11"," 2.34"," 1.98","-1.39","-0.97"," 3.03"," 3.18","-1.06","-1.35"," 2.70"," 1.95","-1.27"," 3.54"," 2.54","-1.44"," 3.26","-1.02"," 7.39"," 1.27"," 2.35"," 4.88"," 7.42","-1.60","-1.55"," 1.62","-1.10","-1.13"," 0.99","-1.23","-0.99"," 1.66"," 2.89"," 5.59"," 1.06"," 2.02"," 7.42","-1.51"," 4.01","-1.00"," 6.63"," 1.44"," 3.16"," 3.63"," 1.58","-1.18"," 3.52","-0.93"," 2.53"," 1.93","-1.66","-0.96"," 2.03"," 1.58","-1.32"," 5.63"," 3.52"," 2.03","-1.14"," 3.72"," 1.84","-0.80","-1.22"," 1.49"," 2.60"," 6.33"," 1.56","-0.89","-0.98","-1.11","-1.29"," 6.34","-1.19","-0.92"],["1.22e-09","2.78e-09","3.82e-09","4.30e-09","7.77e-09","1.01e-08","1.38e-08","3.07e-08","3.47e-08","7.69e-08","9.94e-08","1.08e-07","1.09e-07","1.14e-07","1.15e-07","1.20e-07","1.27e-07","1.49e-07","1.59e-07","1.76e-07","2.05e-07","2.34e-07","2.62e-07","2.74e-07","2.74e-07","3.00e-07","3.11e-07","3.76e-07","4.02e-07","4.22e-07","4.75e-07","4.78e-07","4.84e-07","5.23e-07","5.45e-07","5.46e-07","5.64e-07","5.75e-07","6.03e-07","6.26e-07","6.37e-07","6.91e-07","6.93e-07","6.95e-07","7.01e-07","7.24e-07","7.45e-07","7.59e-07","8.41e-07","8.60e-07","8.69e-07","8.81e-07","8.84e-07","8.99e-07","9.33e-07","9.84e-07","1.01e-06","1.06e-06","1.09e-06","1.10e-06","1.12e-06","1.13e-06","1.18e-06","1.20e-06","1.21e-06","1.23e-06","1.23e-06","1.25e-06","1.29e-06","1.29e-06","1.33e-06","1.35e-06","1.35e-06","1.38e-06","1.41e-06","1.46e-06","1.47e-06","1.50e-06","1.54e-06","1.61e-06","1.68e-06","1.69e-06","1.69e-06","1.70e-06","1.73e-06","1.75e-06","1.79e-06","1.81e-06","1.83e-06","1.86e-06","1.94e-06","2.02e-06","2.04e-06","2.09e-06","2.14e-06","2.22e-06","2.24e-06","2.26e-06","2.28e-06","2.33e-06"],["2.24e-06","2.24e-06","2.24e-06","2.24e-06","3.23e-06","3.51e-06","4.09e-06","7.99e-06","8.01e-06","1.55e-05","1.55e-05","1.55e-05","1.55e-05","1.55e-05","1.55e-05","1.55e-05","1.56e-05","1.72e-05","1.74e-05","1.83e-05","2.03e-05","2.21e-05","2.28e-05","2.28e-05","2.28e-05","2.40e-05","2.40e-05","2.80e-05","2.88e-05","2.93e-05","3.05e-05","3.05e-05","3.05e-05","3.15e-05","3.15e-05","3.15e-05","3.15e-05","3.15e-05","3.21e-05","3.23e-05","3.23e-05","3.24e-05","3.24e-05","3.24e-05","3.24e-05","3.27e-05","3.29e-05","3.29e-05","3.46e-05","3.46e-05","3.46e-05","3.46e-05","3.46e-05","3.46e-05","3.53e-05","3.66e-05","3.70e-05","3.78e-05","3.78e-05","3.78e-05","3.78e-05","3.78e-05","3.82e-05","3.82e-05","3.82e-05","3.82e-05","3.82e-05","3.82e-05","3.84e-05","3.84e-05","3.85e-05","3.85e-05","3.85e-05","3.88e-05","3.92e-05","3.98e-05","3.98e-05","4.01e-05","4.06e-05","4.20e-05","4.20e-05","4.20e-05","4.20e-05","4.20e-05","4.22e-05","4.24e-05","4.27e-05","4.27e-05","4.27e-05","4.30e-05","4.43e-05","4.56e-05","4.57e-05","4.63e-05","4.68e-05","4.79e-05","4.79e-05","4.79e-05","4.79e-05","4.84e-05"],["1.84e-05","1.84e-05","1.84e-05","1.84e-05","2.66e-05","2.89e-05","3.36e-05","6.57e-05","6.58e-05","1.28e-04","1.28e-04","1.28e-04","1.28e-04","1.28e-04","1.28e-04","1.28e-04","1.28e-04","1.41e-04","1.43e-04","1.51e-04","1.67e-04","1.82e-04","1.88e-04","1.88e-04","1.88e-04","1.97e-04","1.97e-04","2.30e-04","2.37e-04","2.41e-04","2.51e-04","2.51e-04","2.51e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.64e-04","2.65e-04","2.65e-04","2.66e-04","2.66e-04","2.66e-04","2.66e-04","2.69e-04","2.70e-04","2.70e-04","2.85e-04","2.85e-04","2.85e-04","2.85e-04","2.85e-04","2.85e-04","2.90e-04","3.00e-04","3.04e-04","3.10e-04","3.10e-04","3.10e-04","3.10e-04","3.10e-04","3.14e-04","3.14e-04","3.14e-04","3.14e-04","3.14e-04","3.14e-04","3.15e-04","3.15e-04","3.16e-04","3.16e-04","3.16e-04","3.19e-04","3.22e-04","3.27e-04","3.27e-04","3.29e-04","3.33e-04","3.45e-04","3.45e-04","3.45e-04","3.45e-04","3.45e-04","3.47e-04","3.49e-04","3.51e-04","3.51e-04","3.51e-04","3.53e-04","3.64e-04","3.75e-04","3.76e-04","3.81e-04","3.85e-04","3.93e-04","3.93e-04","3.93e-04","3.93e-04","3.97e-04"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are some differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">2.3</span>),</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 6"</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-7-1" class="level2">
<h2 class="anchored" data-anchor-id="k-7-1">k = 7</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k7topTable,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 7-mers."</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k7topTable, DE)),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k7topTable),</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-05a822ba7e8f875cf301" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-05a822ba7e8f875cf301">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 7-mers. 2189 of 8192 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["TAATACA","AGATCTA","ACGTATC","GGGTCTA","GATCTAC","AGTAATA","CGTATCA","ATTCTCC","AATCCAA","TCTAAGA","GTAATAC","TAATCCA","ACCAGGG","ACATAGC","AGGACAA","GGCGCGA","GGGAGAA","AATACAG","CGCGATC","CGGCACG","ATTACTC","CCGGGTA","ATCTACA","ATCGCGC","AATAGAC","AATCAGG","CTAGACC","ATTACAG","TGGATAA","ACGGGGG","ACCCATC","CGTCGGA","CTATTCA","ACACCCA","GTGCCGA","ATCTAAG","GAGAATC","GCGATCC","ACGTCGG","CCGTGCC","CGGGGGC","AGGTCGG","TGAGTAA","AATTTCT","CACGGGG","CCCGTGC","CAGGTCG","ATCAGTA","CGTCTAA","GGTCAAA","AGGTCAA","CCTTAGA","AGGCGCG","CGATCCC","GATTACA","GGTTCAC","AGCCCCC","ATTTCTG","CCGATCA","GGTCGGA","ACATTTG","ATCGGCA","AACTCAG","GAATAGA","CTAAGGA","CAAGCTA","CTGAGTA","ACGTCAT","ACTACTG","CCTACGC","GATCGGC","CTTAGAC","CAGGCGC","GCAGTGA","TAGACGA","TGATCAA","GTCCTGA","AGTAGTG","GGATAAA","ACAACCA","CTACAGC","ACCGGCC","CCAGTAA","ACAGGCG","CATTTGG","CGATCAG","CCGGTTC","AATGTTG","CGGCCCA","ATCAATG","CTGTAGA","ACGACCT","CGACGTC","AACTTAG","ATCCGTC","CTTGGAA","ACCTGGG","AGAGCTA","ATAACCG","GCTTTGA"],[" 8.11"," 6.81"," 5.26"," 5.28"," 6.60"," 8.08"," 5.37"," 7.26"," 7.91"," 6.21"," 7.60"," 7.50"," 7.04"," 6.22"," 7.54"," 7.49"," 7.53"," 8.36"," 7.48"," 7.55"," 7.66"," 4.88"," 7.44"," 7.48"," 7.92"," 7.15"," 5.60"," 7.77"," 7.52"," 7.59"," 6.86"," 5.23"," 7.94"," 7.24"," 7.66"," 6.01"," 7.04"," 7.57"," 5.12"," 7.68"," 7.65"," 7.60"," 7.90"," 8.13"," 7.69"," 7.64"," 8.69"," 8.09"," 7.81"," 8.32"," 8.51"," 7.74"," 7.63"," 7.59"," 7.31"," 8.21"," 7.87"," 8.47"," 7.71"," 7.62"," 8.46"," 8.40"," 7.11"," 7.90"," 7.81"," 7.07"," 7.66"," 6.62"," 7.97"," 4.93"," 8.39"," 7.86"," 7.89"," 7.41"," 7.83"," 7.82"," 7.25"," 7.88"," 7.38"," 7.43"," 7.45"," 7.68"," 6.83"," 7.92"," 7.82"," 7.80"," 7.66"," 8.04"," 7.73"," 7.46"," 7.51"," 7.88"," 5.40"," 7.52"," 6.26"," 6.62"," 7.88"," 6.59"," 5.38"," 8.33"],[" 6.53","-3.23"," 2.71","-1.91","-3.82"," 6.56"," 2.60","-2.00"," 3.69","-3.14"," 8.23"," 4.36","-2.83","-3.50","-1.66","10.91","-2.26"," 5.06","10.51","10.47"," 7.79"," 3.81","-1.91","10.51"," 7.64","-1.65","-1.92"," 2.58","-2.32","10.04","-2.38","-6.47"," 7.36","-1.90"," 9.48","-3.28","-1.90"," 9.60","-6.65"," 9.41"," 9.48"," 9.84"," 6.30"," 3.83"," 9.34"," 9.59","10.15"," 6.93","10.00"," 6.33"," 7.83"," 9.27","10.20"," 9.40"," 3.23"," 9.00"," 8.40"," 3.11"," 8.94"," 9.57"," 4.37"," 9.73","-1.99"," 7.28"," 9.09"," 6.39"," 7.43","-2.41"," 7.28","-4.95"," 9.77"," 9.34"," 9.07","-1.46"," 9.55"," 4.15","-2.16"," 7.63","-1.60","-1.03","-2.56"," 8.84","-2.14"," 8.77"," 4.63"," 8.30"," 8.73"," 2.34"," 8.70"," 2.25","-1.74"," 9.32","-5.58"," 8.28","-3.47"," 1.08"," 8.00","-2.43"," 1.07"," 6.04"],["1.04e-09","1.40e-09","1.47e-09","1.49e-09","2.18e-09","2.44e-09","3.64e-09","5.35e-09","5.95e-09","7.35e-09","7.70e-09","7.71e-09","8.60e-09","9.55e-09","9.66e-09","1.01e-08","1.06e-08","1.41e-08","1.51e-08","1.52e-08","1.59e-08","1.69e-08","1.70e-08","1.78e-08","2.03e-08","2.28e-08","2.60e-08","2.85e-08","3.09e-08","3.11e-08","3.21e-08","3.21e-08","3.50e-08","3.85e-08","4.07e-08","4.10e-08","4.21e-08","4.64e-08","4.72e-08","4.79e-08","5.21e-08","5.22e-08","5.26e-08","5.32e-08","5.37e-08","5.46e-08","5.47e-08","5.51e-08","5.94e-08","6.24e-08","6.40e-08","6.48e-08","6.49e-08","6.68e-08","6.78e-08","6.84e-08","7.19e-08","7.34e-08","7.43e-08","8.08e-08","8.16e-08","8.45e-08","8.47e-08","8.54e-08","8.64e-08","9.76e-08","9.91e-08","1.00e-07","1.03e-07","1.03e-07","1.06e-07","1.10e-07","1.17e-07","1.18e-07","1.22e-07","1.27e-07","1.29e-07","1.30e-07","1.44e-07","1.46e-07","1.47e-07","1.48e-07","1.49e-07","1.51e-07","1.55e-07","1.55e-07","1.65e-07","1.76e-07","1.77e-07","1.77e-07","1.77e-07","1.80e-07","1.85e-07","1.87e-07","1.88e-07","1.91e-07","1.92e-07","1.92e-07","1.93e-07","1.93e-07"],["3.05e-06","3.05e-06","3.05e-06","3.05e-06","3.33e-06","3.33e-06","4.26e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","5.10e-06","6.06e-06","6.06e-06","6.06e-06","6.06e-06","6.06e-06","6.06e-06","6.06e-06","6.65e-06","7.17e-06","7.90e-06","8.22e-06","8.22e-06","8.22e-06","8.22e-06","8.22e-06","8.69e-06","9.29e-06","9.32e-06","9.32e-06","9.32e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.41e-06","9.94e-06","1.00e-05","1.00e-05","1.00e-05","1.00e-05","1.00e-05","1.00e-05","1.00e-05","1.03e-05","1.03e-05","1.03e-05","1.09e-05","1.09e-05","1.09e-05","1.09e-05","1.09e-05","1.09e-05","1.21e-05","1.21e-05","1.21e-05","1.21e-05","1.21e-05","1.22e-05","1.26e-05","1.31e-05","1.31e-05","1.34e-05","1.37e-05","1.37e-05","1.37e-05","1.47e-05","1.47e-05","1.47e-05","1.47e-05","1.47e-05","1.47e-05","1.48e-05","1.48e-05","1.56e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05","1.58e-05"],["2.92e-05","2.92e-05","2.92e-05","2.92e-05","3.19e-05","3.19e-05","4.09e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","4.89e-05","5.81e-05","5.81e-05","5.81e-05","5.81e-05","5.81e-05","5.81e-05","5.81e-05","6.38e-05","6.88e-05","7.57e-05","7.88e-05","7.88e-05","7.88e-05","7.88e-05","7.88e-05","8.33e-05","8.91e-05","8.94e-05","8.94e-05","8.94e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.02e-05","9.53e-05","9.59e-05","9.59e-05","9.59e-05","9.59e-05","9.59e-05","9.59e-05","9.59e-05","9.89e-05","9.89e-05","9.89e-05","1.04e-04","1.04e-04","1.04e-04","1.04e-04","1.04e-04","1.04e-04","1.16e-04","1.16e-04","1.16e-04","1.16e-04","1.16e-04","1.17e-04","1.21e-04","1.25e-04","1.25e-04","1.28e-04","1.31e-04","1.31e-04","1.31e-04","1.41e-04","1.41e-04","1.41e-04","1.41e-04","1.41e-04","1.41e-04","1.42e-04","1.42e-04","1.49e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04","1.52e-04"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 7"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">6.4</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">5</span>),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 7"</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-8-1" class="level2">
<h2 class="anchored" data-anchor-id="k-8-1">k = 8</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k8topTable,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 8-mers."</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k8topTable, DE)),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k8topTable),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b365e70904023a7fcd9f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b365e70904023a7fcd9f">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 8-mers. 7401 of 32896 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CGGGTACC","ACCAGGGA","CCCTGGTC","CCTGATTC","ATTCTCCC","ATCCGACG","AAGATCTA","CCAGGGAG","AGGGAGAA","CATTACGA","ACGTCGGA","CTACTAAG","GATTCTCC","CAGGACAA","ATCTACAG","GATCTACA","GAGAATCA","CTCTTAGA","CATCTAAG","CTGAGTCA","AGATCTAC","AGAATCAG","CCATCCGA","AATCAGGA","CATAGCTC","ACCTACGC","GCTGTAGA","GCGGTCCC","AGAGCTAT","CAGGGACC","TCAGGACA","CTAAGAGC","ATCTAAGA","CGTATCAA","GTAACAAC","ATCAGGAC","AGGACAAG","CCGACGTC","AACCTACG","ATAAGAAG","AACATAGC","AATTCGTG","CAACCTAC","ACGTATCA","CGGATGGA","CTAAGATC","AGCGTAGG","CTACAGCA","CTCGCCAC","TCATCTAA","GGATGGAA","CGTGCCGA","CGACGTCA","ACTCAGTC","GAGTAATA","CCGTGCCG","GTCATCTA","CTGTATTA","ACGGGGGC","CATCCGAC","ATCGCGCC","AATAACCG","GATCGCGC","GGCGGCTA","GCGATCCC","CGCGATCC","CACGGGGG","AGGCGCGA","TACGTCGA","ATCGGCAC","GTAATACA","TAAGATCA","AAGAGCTA","CCTGGTCC","AGTAATAC","CCCGTGCC","ACTGATCG","CAGGCGCG","ACATAGCT","CCCCGTGC","ACATCTGG","ATTACTCA","ATCTTAGC","AGGTCGGA","ACAACCTA","GGTTTCAC","CAGGGGCC","GAATAGAC","CGATCCCA","TAGTGGGA","AGCCCCCG","CCCCCTTC","AACCGGCC","CCGATCAG","ATCTTTGG","CTATTCAC","AGCTCTTA","GAGTACCC","AAGCCCCC","GGGTCTAC"],[" 3.49"," 5.24"," 5.33"," 5.41"," 5.49"," 4.38"," 5.66"," 5.36"," 6.26"," 3.63"," 4.39"," 3.27"," 5.66"," 6.05"," 6.07"," 5.76"," 5.77"," 4.89"," 4.91"," 5.04"," 5.80"," 5.93"," 4.75"," 5.91"," 4.77"," 3.74"," 6.01"," 3.62"," 4.95"," 4.80"," 6.04"," 4.80"," 4.99"," 3.30"," 5.05"," 5.73"," 5.90"," 4.48"," 3.92"," 5.63"," 5.16"," 2.93"," 4.36"," 4.14"," 5.22"," 3.89"," 3.91"," 6.36"," 4.32"," 5.52"," 5.83"," 7.40"," 4.70"," 5.38"," 7.23"," 7.41"," 5.21"," 7.30"," 7.41"," 4.79"," 7.31"," 3.95"," 7.34"," 3.78"," 7.35"," 7.34"," 7.44"," 7.32"," 2.41"," 7.44"," 7.24"," 5.00"," 5.28"," 5.59"," 7.24"," 7.44"," 7.45"," 7.32"," 5.08"," 7.44"," 5.46"," 7.23"," 4.17"," 7.42"," 4.74"," 5.19"," 4.76"," 7.37"," 7.41"," 7.48"," 7.44"," 5.39"," 7.37"," 7.46"," 5.67"," 7.40"," 5.33"," 2.43"," 7.55"," 3.83"],["  7.56"," -6.26"," -6.23"," -4.98"," -4.71","-11.08"," -6.72"," -5.85"," -3.72","  2.46","-10.82","  3.15"," -4.38"," -3.28"," -5.38"," -6.47"," -3.84"," -7.63"," -7.47"," -2.64"," -6.29"," -3.34"," -8.75"," -3.48"," -8.39"," -9.55"," -5.82","  5.20"," -7.19"," -7.00"," -3.56"," -8.17"," -6.91","  2.51"," -7.07"," -4.04"," -3.88","-10.09"," -8.38","  3.57"," -6.22","  2.22"," -6.66","  6.56"," -7.22","  3.66"," -8.50"," -4.78"," -2.91"," -4.86"," -4.98"," 12.52"," -8.72"," -7.23"," 11.03"," 12.35"," -6.22"," 10.30"," 12.34"," -8.52"," 12.40","  2.74"," 12.33","  4.97"," 12.24"," 12.30"," 12.22"," 12.27","  4.29"," 11.98"," 10.67","  3.34"," -5.96"," -5.05"," 10.70"," 12.11"," 11.84"," 12.15"," -7.00"," 12.13","  2.46"," 10.72","  2.48"," 12.11"," -4.88","  2.96"," -3.35"," 11.39"," 11.66"," 10.84"," 11.76"," -2.76"," 11.89"," 11.51"," -3.30"," 11.15"," -5.49"," -1.69"," 11.11"," -3.75"],["1.08e-11","2.28e-11","2.46e-11","5.62e-11","1.07e-10","1.12e-10","1.28e-10","1.66e-10","2.44e-10","2.49e-10","2.52e-10","2.97e-10","3.32e-10","3.80e-10","4.15e-10","4.39e-10","4.78e-10","5.15e-10","6.31e-10","6.31e-10","6.95e-10","7.02e-10","7.13e-10","7.79e-10","7.95e-10","8.27e-10","9.13e-10","9.18e-10","9.42e-10","9.46e-10","9.65e-10","1.02e-09","1.09e-09","1.14e-09","1.24e-09","1.26e-09","1.29e-09","1.36e-09","1.47e-09","1.68e-09","1.84e-09","2.31e-09","2.33e-09","2.41e-09","2.62e-09","2.88e-09","2.95e-09","2.97e-09","2.97e-09","3.19e-09","3.21e-09","3.53e-09","3.65e-09","3.67e-09","3.77e-09","4.20e-09","4.49e-09","4.55e-09","4.55e-09","4.56e-09","4.56e-09","4.73e-09","4.75e-09","4.78e-09","4.81e-09","4.83e-09","4.92e-09","4.97e-09","4.97e-09","5.13e-09","5.31e-09","5.35e-09","5.62e-09","5.64e-09","5.69e-09","5.88e-09","5.91e-09","5.97e-09","6.17e-09","6.30e-09","6.55e-09","6.79e-09","6.84e-09","6.87e-09","6.88e-09","7.04e-09","7.08e-09","7.19e-09","7.30e-09","7.52e-09","7.67e-09","7.69e-09","7.89e-09","8.05e-09","8.07e-09","8.29e-09","8.39e-09","8.44e-09","8.57e-09","9.04e-09"],["2.70e-07","2.70e-07","2.70e-07","4.62e-07","6.04e-07","6.04e-07","6.04e-07","6.85e-07","7.54e-07","7.54e-07","7.54e-07","8.14e-07","8.39e-07","8.92e-07","9.03e-07","9.03e-07","9.24e-07","9.40e-07","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.02e-06","1.05e-06","1.08e-06","1.10e-06","1.14e-06","1.14e-06","1.14e-06","1.17e-06","1.24e-06","1.38e-06","1.47e-06","1.78e-06","1.78e-06","1.80e-06","1.91e-06","2.00e-06","2.00e-06","2.00e-06","2.00e-06","2.07e-06","2.07e-06","2.23e-06","2.24e-06","2.24e-06","2.26e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.37e-06","2.41e-06","2.44e-06","2.44e-06","2.49e-06","2.49e-06","2.49e-06","2.52e-06","2.52e-06","2.52e-06","2.57e-06","2.59e-06","2.66e-06","2.66e-06","2.66e-06","2.66e-06","2.66e-06","2.68e-06","2.68e-06","2.69e-06","2.70e-06","2.75e-06","2.75e-06","2.75e-06","2.79e-06","2.79e-06","2.79e-06","2.83e-06","2.83e-06","2.83e-06","2.85e-06","2.94e-06"],["2.96e-06","2.96e-06","2.96e-06","5.07e-06","6.63e-06","6.63e-06","6.63e-06","7.51e-06","8.27e-06","8.27e-06","8.27e-06","8.93e-06","9.22e-06","9.80e-06","9.91e-06","9.91e-06","1.01e-05","1.03e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.12e-05","1.15e-05","1.19e-05","1.21e-05","1.26e-05","1.26e-05","1.26e-05","1.29e-05","1.36e-05","1.51e-05","1.62e-05","1.95e-05","1.95e-05","1.98e-05","2.10e-05","2.19e-05","2.19e-05","2.19e-05","2.19e-05","2.27e-05","2.27e-05","2.45e-05","2.46e-05","2.46e-05","2.48e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.60e-05","2.65e-05","2.68e-05","2.68e-05","2.74e-05","2.74e-05","2.74e-05","2.76e-05","2.76e-05","2.76e-05","2.82e-05","2.84e-05","2.92e-05","2.92e-05","2.92e-05","2.92e-05","2.92e-05","2.94e-05","2.94e-05","2.95e-05","2.96e-05","3.02e-05","3.02e-05","3.02e-05","3.06e-05","3.07e-05","3.07e-05","3.11e-05","3.11e-05","3.11e-05","3.13e-05","3.23e-05"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">7.2</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="fl">12.5</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 8"</span>) <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-9-1" class="level2">
<h2 class="anchored" data-anchor-id="k-9-1">k = 9</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k9topTable,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 9-mers."</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k9topTable, DE)),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k9topTable),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-858478e0f48be66ccca3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-858478e0f48be66ccca3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 9-mers. 27656 of 131072 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CGACGGGTA","CTTAGTAGC","ACATAGCTC","ACGTCGGAT","CATCCGACG","GCAGGGACC","GACGTCGGA","CGGATGGAA","TCCATCCGA","ATGACGTCG","ATCTAAGAG","CCATCCGAC","GCTCTTAGA","AAAGATCTA","CCGACGTCA","CCCTGGTCC","GCGGGTACC","CAACATAGC","CTGTAGATC","AACATAGCT","AAGAGCTAT","CTTAGATGA","CCGAAGATA","AGAGCTATG","AGCTCTTAG","CAGGGACCA","ATCTACAGC","GTCATCTAA","CCCGACGGG","AAATCGTAA","AGATCTACA","TACTAAGAA","AATTGCTCT","CTATTACCA","CGTCATCTA","CAACCTACG","ACCAGGGAG","CATCTAAGA","GACCAGGGA","AGTAACAAC","ACAACATAG","ATCCAGTAA","AAGATCTAC","GAATCAGGA","ATCGTAATG","AGCAGGGGC","TCATTACGA","CCAGGGAGA","CGGTCGTTA","TCTACAGCA","GATTCTCCC","ACCTACGCT","GCATCGACC","AACCTACGC","ACGGGTACC","GTAACAACA","AACAACCTA","CGGGTACCC","CAGGACAAG","CTTCCATCC","GCCCCGAGA","AAGCGTAGG","CCTGGTCCC","CCTGCTGTA","AAAGACCTT","ACAGCAGGG","CGGCCCCGA","GGAAGCGTA","ACAACCTAC","AGGGACCAG","ACTCAGTCC","GGAGAATCA","AGAATCAGG","CTGATTCTC","ATCAGGACA","ACGTCATCT","ACCGCCCGT","GTGGTAATA","CGCATCGAC","CTGAGTTTA","AAATGGTAG","TAAGAGCTA","GCAGGGGCC","AACTCAGTC","CAGGGAGAA","ACGGATGTG","CCCCCCTTC","ACTCCCATG","GAGTTTATC","ATGTTGTTA","CGGATGTGC","CTATCGAAG","CGTCGGGGA","CCAGTAACA","CCCAAGTGA","AAATTGCTC","ATGGAAGCG","CCCGGACGG","ACATCCGTC","GTTACTGGA"],[" 0.74"," 1.83"," 4.16"," 4.11"," 4.14"," 4.15"," 4.14"," 4.35"," 4.27"," 4.22"," 4.27"," 4.27"," 4.30"," 5.13"," 4.21"," 4.69"," 1.34"," 4.31"," 5.20"," 4.45"," 4.31"," 4.32"," 0.67"," 4.30"," 4.29"," 4.23"," 5.27"," 4.43"," 1.22"," 2.49"," 5.24"," 2.40"," 3.05"," 2.39"," 4.32"," 3.36"," 4.64"," 4.39"," 4.61"," 4.44"," 4.47"," 4.48"," 5.22"," 4.74"," 2.13"," 4.02"," 2.26"," 4.69","-0.27"," 5.40"," 4.68"," 3.34"," 2.69"," 3.44"," 1.11"," 4.61"," 3.82"," 2.05"," 4.89"," 4.68"," 1.66"," 3.39"," 4.25"," 5.38"," 3.40"," 5.41"," 1.60"," 3.47"," 3.66"," 4.29"," 4.68"," 4.80"," 4.76"," 4.89"," 4.87"," 4.45"," 0.88"," 2.66"," 2.48"," 4.60"," 2.98"," 4.43"," 3.76"," 4.44"," 5.38"," 4.05"," 2.88"," 2.95"," 4.49"," 4.84"," 4.08"," 0.24"," 2.72"," 4.53"," 2.57"," 3.01"," 3.61"," 1.23"," 4.10"," 4.48"],[" 12.00","  7.37","-12.77","-13.57","-13.26","-10.75","-13.20","-11.35","-12.04","-12.42","-11.82","-12.30","-11.73","-10.13","-12.45"," -9.40","  9.06","-11.75"," -9.84","-10.50","-11.43","-11.33","  3.48","-11.46","-11.66"," -9.29"," -9.33","-10.53","  7.72","  5.41"," -9.36","  5.97","  3.19","  4.13","-11.48","-12.26"," -9.19","-10.86"," -9.52","-10.72","-10.27"," -9.99"," -9.32"," -7.85","  5.58"," -6.00","  5.61"," -8.10"," -4.45"," -8.51"," -8.06","-12.31","  5.91","-11.47","  8.02"," -9.72"," -9.00"," 12.55"," -6.63"," -9.54","  7.27","-11.93"," -8.97"," -8.22","  2.82"," -8.13","  7.79","-11.51"," -9.75"," -8.75","-10.86"," -7.21"," -7.49"," -6.83"," -6.42","-10.64","  8.50","  3.35","  7.28"," -8.93","  3.92","-10.28"," -5.77","-10.14"," -5.48","-10.78"," -3.13","  2.93"," -9.85"," -7.74","-10.82","  3.58"," 11.22"," -9.70","  3.05","  2.76"," -9.59","  6.49","-10.32"," -9.81"],["8.50e-14","3.77e-12","6.32e-12","7.50e-12","9.40e-12","1.04e-11","1.12e-11","1.43e-11","1.49e-11","1.57e-11","1.59e-11","1.61e-11","1.72e-11","2.06e-11","2.09e-11","2.36e-11","2.46e-11","2.57e-11","2.85e-11","3.14e-11","3.43e-11","4.22e-11","4.52e-11","4.71e-11","4.75e-11","4.76e-11","4.93e-11","4.95e-11","5.18e-11","5.19e-11","5.80e-11","6.28e-11","6.93e-11","7.07e-11","7.37e-11","7.69e-11","7.70e-11","7.73e-11","8.02e-11","8.39e-11","8.53e-11","8.56e-11","8.84e-11","9.22e-11","9.55e-11","9.80e-11","1.01e-10","1.07e-10","1.12e-10","1.18e-10","1.20e-10","1.21e-10","1.36e-10","1.38e-10","1.40e-10","1.54e-10","1.67e-10","1.77e-10","1.79e-10","1.81e-10","1.81e-10","1.91e-10","1.94e-10","1.97e-10","1.97e-10","2.13e-10","2.18e-10","2.21e-10","2.24e-10","2.25e-10","2.43e-10","2.48e-10","2.48e-10","2.73e-10","2.90e-10","3.08e-10","3.19e-10","3.21e-10","3.23e-10","3.50e-10","3.63e-10","3.79e-10","3.83e-10","3.91e-10","3.97e-10","4.01e-10","4.08e-10","4.12e-10","4.19e-10","4.26e-10","4.41e-10","4.42e-10","4.42e-10","4.56e-10","4.97e-10","5.06e-10","5.26e-10","5.44e-10","6.04e-10","6.21e-10"],["1.11e-08","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.73e-07","1.82e-07","1.82e-07","1.87e-07","1.87e-07","1.87e-07","1.97e-07","2.06e-07","2.14e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.27e-07","2.45e-07","2.57e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.67e-07","2.69e-07","2.75e-07","2.78e-07","2.79e-07","2.82e-07","2.93e-07","2.99e-07","3.04e-07","3.04e-07","3.04e-07","3.35e-07","3.35e-07","3.35e-07","3.60e-07","3.84e-07","3.90e-07","3.90e-07","3.90e-07","3.90e-07","3.98e-07","3.98e-07","3.98e-07","3.98e-07","4.21e-07","4.21e-07","4.21e-07","4.21e-07","4.21e-07","4.46e-07","4.46e-07","4.46e-07","4.84e-07","5.07e-07","5.31e-07","5.36e-07","5.36e-07","5.36e-07","5.73e-07","5.88e-07","6.05e-07","6.05e-07","6.10e-07","6.12e-07","6.12e-07","6.14e-07","6.14e-07","6.16e-07","6.20e-07","6.23e-07","6.23e-07","6.23e-07","6.35e-07","6.86e-07","6.91e-07","7.11e-07","7.27e-07","7.99e-07","7.99e-07"],["1.38e-07","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.14e-06","2.26e-06","2.26e-06","2.31e-06","2.31e-06","2.31e-06","2.43e-06","2.55e-06","2.65e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","2.80e-06","3.03e-06","3.18e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.30e-06","3.33e-06","3.39e-06","3.44e-06","3.45e-06","3.49e-06","3.63e-06","3.69e-06","3.76e-06","3.76e-06","3.76e-06","4.14e-06","4.14e-06","4.14e-06","4.45e-06","4.75e-06","4.82e-06","4.82e-06","4.82e-06","4.82e-06","4.91e-06","4.91e-06","4.91e-06","4.91e-06","5.21e-06","5.21e-06","5.21e-06","5.21e-06","5.21e-06","5.51e-06","5.51e-06","5.51e-06","5.99e-06","6.26e-06","6.56e-06","6.63e-06","6.63e-06","6.63e-06","7.09e-06","7.26e-06","7.48e-06","7.48e-06","7.54e-06","7.56e-06","7.56e-06","7.59e-06","7.59e-06","7.62e-06","7.66e-06","7.70e-06","7.70e-06","7.70e-06","7.85e-06","8.48e-06","8.55e-06","8.79e-06","8.99e-06","9.87e-06","9.87e-06"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 9"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(DE <span class="sc">&amp;</span> <span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">7.5</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">15</span>),</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 9"</span>) <span class="sc">+</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-10-1" class="level2">
<h2 class="anchored" data-anchor-id="k-10-1">k = 10</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k10topTable,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 10-mers."</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k10topTable, DE)),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k10topTable),</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d63a6d0929fd1989da27" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d63a6d0929fd1989da27">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 10-mers. 116608 of 524800 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CCCCGACGGG","ACCCGTCGGG","CCGTCTCGAC","CGTCGGGGAG","CGACGGGTAC","TACTAAGAAA","AATTTCCAAG","GACGGGTACC","CACTCCCATG","AAATCGTAAT","CCGTCGGGGA","AAAATCGTAA","ACTTAATAAC","CGTAATGAAA","CAGGCGGGTA","AATTGCTCTC","AACATAGCTC","GCGGTCGGCA","ATCGTAATGA","CTAAGAGCTA","ATAGCTCTTA","ACGTCGGATG","CGTAAAGTAC","CCATCCGACG","ACATAGCTCT","CTTAATAACC","TCGGATGGAA","TTAGTAGCAA","GTCGGATGGA","ATCCGACGTC","AAGAGCTATG","GGTAATAGGA","CCCCGTCGAG","CGGGAAGGTC","AATCGTAATG","CATCTAAGAG","CGTTCCACGA","ACGTCATCTA","CCCGTCGAGA","GGCCCCGAGA","CGTCATCTAA","CTTAGGATCC","CGGATGGAAG","AGCTCTTAGA","ATGACGTCGG","ATCTAAGAGC","AGCTATGTTG","CAATTTCCAA","CGGGCGCCTC","CTTAGATGAC","TATCCAGTAA","AAGGTCTTTG","AGTGGTAATA","ATGGTAGGCG","TCCGACGTCA","GATCTTATAA","ATTCCTTTTA","CGACGTCATC","AACTAAGACG","CCCTGGTCCC","GCAGGGACCA","CGTGGGTTCA","CGGCCCCGAG","GGGAGTGGTA","CTTTGAACCC","CTACCGTTAA","ACAACATAGC","AGCAGGGACC","GACGGGCGCC","CAGGGACCAG","GGTCGGCGAC","AAAATGGTAG","GAGTTTATCC","TCATCTAAGA","AGGGACCAGG","AGATGACGTC","ATCCAGTAAC","GCTACTAAGA","AACAACATAG","CAGTAACAAC","CCAGTAACAA","CACGGCCCCG","ATGTTGTTAC","GCAATTTCCA","ACCCGCCTGG","AGGCGGGTAC","CGCCTCCCCG","CAACTTAATA","TAACCCAATA","ACGGGTACCC","CCACGGCCCC","ACGGATGTGC","ACTGAGTTTA","CGCCCGTCCG","AGTAACAACA","CAGCAGGGAC","CGTCGAGACG","ACCCACGGCC","AGGTTTTCGC","TAACAACATA"],[" 0.48"," 0.58"," 0.71"," 0.52"," 0.57"," 1.70"," 1.74"," 0.76"," 1.65"," 1.49"," 0.74"," 1.75"," 1.54"," 1.55"," 1.19"," 1.68"," 4.04"," 0.63"," 1.37"," 4.05"," 4.05"," 4.05","-0.41"," 4.05"," 4.04"," 1.16"," 4.08"," 1.50"," 4.10"," 4.06"," 4.07"," 1.07"," 0.62"," 0.87"," 1.28"," 4.09","-1.39"," 4.08"," 0.61"," 1.09"," 4.08","-1.23"," 4.13"," 4.10"," 4.08"," 4.10"," 4.09"," 2.12"," 0.55"," 4.08"," 4.05"," 1.90"," 1.45"," 0.93"," 4.09"," 0.85"," 2.12"," 4.11","-1.05"," 3.86"," 3.91"," 1.24"," 1.15"," 1.12"," 1.44","-0.81"," 4.14"," 4.00"," 0.46"," 3.95"," 0.31"," 1.76"," 4.06"," 4.15"," 3.92"," 4.13"," 4.06"," 1.18"," 4.19"," 4.15"," 4.15"," 1.26"," 4.17"," 1.84"," 1.24"," 1.01"," 0.59"," 1.53"," 0.98"," 0.63"," 1.59"," 3.77"," 4.10"," 0.50"," 4.23"," 4.15"," 0.44"," 1.21","-0.18"," 4.28"],[" 11.45"," 12.46","  9.50"," 10.50"," 14.46","  8.17","  7.94"," 10.50","  7.37","  9.27","  9.59","  7.66","  7.03","  8.84"," 10.32","  7.52","-14.21"," 10.13","  9.57","-14.40","-14.30","-14.50","  5.73","-14.40","-14.08","  7.99","-13.90","  9.51","-13.99","-14.34","-14.09"," 10.28"," 10.58","  9.29"," 10.05","-13.98","  9.28","-14.09","  9.22"," 11.63","-14.08","  7.11","-13.44","-13.84","-14.01","-13.82","-13.98","  6.93"," 11.27","-13.96","-13.87","  5.76","  7.84"," 12.91","-13.98","  4.34","  6.90","-13.70"," -5.72","-12.19","-12.07","  9.87"," 11.43","  9.67","  9.31","  8.57","-13.40","-12.05"," 12.38","-11.69"," 10.39","  7.55","-13.73","-13.28","-11.84","-13.53","-13.59"," 10.34","-12.92","-13.30","-13.27"," 10.05","-13.06","  6.55","  9.96"," 12.42"," 11.00","  7.90","  7.11"," 14.48","  9.80","-13.44","-12.99"," 11.15","-12.89","-11.41"," 11.98","  9.96","  5.43","-12.05"],["1.82e-13","3.43e-13","4.99e-13","6.33e-13","1.04e-12","2.00e-12","2.18e-12","2.48e-12","3.02e-12","3.32e-12","3.53e-12","3.88e-12","4.03e-12","4.31e-12","4.41e-12","4.73e-12","4.74e-12","4.83e-12","4.85e-12","5.24e-12","5.50e-12","5.64e-12","5.65e-12","5.90e-12","5.99e-12","6.13e-12","6.50e-12","6.71e-12","6.72e-12","6.82e-12","6.89e-12","6.91e-12","6.93e-12","6.94e-12","7.25e-12","7.43e-12","7.47e-12","7.94e-12","8.07e-12","8.09e-12","8.23e-12","8.25e-12","8.31e-12","8.40e-12","8.54e-12","8.66e-12","8.66e-12","8.72e-12","8.75e-12","9.03e-12","9.14e-12","9.29e-12","9.53e-12","1.01e-11","1.03e-11","1.04e-11","1.06e-11","1.08e-11","1.13e-11","1.14e-11","1.15e-11","1.19e-11","1.19e-11","1.22e-11","1.24e-11","1.25e-11","1.28e-11","1.29e-11","1.30e-11","1.31e-11","1.34e-11","1.37e-11","1.37e-11","1.42e-11","1.45e-11","1.50e-11","1.55e-11","1.68e-11","1.69e-11","1.73e-11","1.76e-11","1.76e-11","1.77e-11","1.80e-11","1.85e-11","1.87e-11","1.93e-11","2.00e-11","2.16e-11","2.26e-11","2.27e-11","2.30e-11","2.32e-11","2.50e-11","2.57e-11","2.71e-11","2.85e-11","2.87e-11","2.96e-11","2.98e-11"],["8.31e-08","8.31e-08","8.31e-08","8.31e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.37e-08","9.44e-08","9.74e-08","9.74e-08","9.74e-08","9.74e-08","9.76e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.85e-08","9.88e-08","9.88e-08","9.88e-08","1.01e-07","1.01e-07","1.04e-07","1.06e-07","1.12e-07","1.12e-07","1.12e-07","1.12e-07","1.12e-07","1.12e-07","1.12e-07","1.14e-07","1.14e-07","1.16e-07","1.19e-07","1.27e-07","1.31e-07","1.31e-07","1.31e-07","1.31e-07","1.40e-07","1.42e-07","1.48e-07","1.54e-07","1.54e-07","1.56e-07","1.56e-07"],["1.14e-06","1.14e-06","1.14e-06","1.14e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.29e-06","1.30e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.36e-06","1.36e-06","1.36e-06","1.38e-06","1.39e-06","1.43e-06","1.45e-06","1.54e-06","1.54e-06","1.54e-06","1.54e-06","1.54e-06","1.54e-06","1.54e-06","1.57e-06","1.57e-06","1.60e-06","1.64e-06","1.75e-06","1.80e-06","1.80e-06","1.80e-06","1.80e-06","1.92e-06","1.95e-06","2.04e-06","2.11e-06","2.11e-06","2.15e-06","2.15e-06"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 10"</span>) <span class="sc">+</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-11-1" class="level2">
<h2 class="anchored" data-anchor-id="k-11-1">k = 11</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k11topTable,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 11-mers."</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k11topTable, DE)),</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k11topTable),</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9c7cd78b6ef5512f9456" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9c7cd78b6ef5512f9456">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 11-mers. 432402 of 2097152 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["GCGAGCTCCCC","AGCGAGCTCCC","ACGACGTTGGA","CCGTTCCACGA","CCCGTCGGGGA","AACGTCGTGGA","CGTCGTGGAAC","GCCGGGGACAA","AGCTCCCCGAC","CGTTGGATAGC","GAGCTCCCCGA","AGACCTTCCCG","CCGTCGGGGAG","ACCCGTCGGGG","ACGAATCAAGT","GGCCGGGGACA","CCGACCGCGCC","CCGCCGGGTAC","CGTCGGGGAGC","GAGAGTATAAC","ATCCCCGCCGC","AAGGTCTTTGA","TAGAAGACGCA","CTGTCGCCGAC","AACGTGCGTCT","ACGTCGTGGAA","CGTTCCACGAC","CGCCGACCGCG","CGGAGTAGGGC","AGCAATTTTAT","GCTGTCGCCGA","CACTCCCATGA","GAACCCACGGC","GACGTAGTCCA","GTAGGAATATA","ACGGGAAGGTC","ATACGTCCCCG","AGACGGGAAGG","GTATATTCCTA","GTAATAGGAGA","CGCCTGGCCTC","CGGCTGAAACC","GAGTGGTAATA","CAAGTCAAATA","ACCTGGCGCGG","TATTAAGTTGA","CCTATTACCAC","CGGTCGGCGAC","AAATCGTAATG","CCGTAAAGTAC","GATTGAGAGTA","ATTACCACTCC","AAAAAACGGGC","ATATGGAAATC","TACTAAGAAAA","AACTTAATAAC","AAGACCTTCCC","ATTTCCAAGTC","GGTCGGCGACA","ATAAAAGGAAT","GATTTTTCTTA","TTGCTATCCAA","GATCAACTTAA","CAAATAAAAGG","CCTCCCCAGTA","CGTCCTGTATA","TCGTAATGAAA","CAACTTAATAA","AATTTTATTCC","CCCGTCTCGAC","CAAGCTTGCTA","AATCGTAATGA","CCTCATGGGAG","AGCTTGCTATC","CGACACCACAA","TACCACTCCCA","GGCCGGGCGCC","ACTTAATAACC","TCCTATTACCA","ATTACTGGGGA","ACAAGCTTGCT","CAATTTCCAAG","AATAGGAGAGC","ACCTTCCCGTC","GGCGCCTCCCC","ATCAACTTAAT","GAACCTGGCGC","CAGTAATTGGG","AAAAGGGGTTG","GTCGTACTGAA","TCAGTACGACA","AGGCCAGGCGG","CTGCCGACCGC","GAAAAATCGTA","AAAATGGTAGG","AAAGACCTTCC","AATTTCCAAGT","TAAAAGGAATA","TTCCAAGTCAA","CTTGCTATCCA"],["  0.23","  0.24"," -1.98"," -2.04","  0.24"," -2.03"," -2.04"," -1.05","  0.31"," -1.12","  0.40","  0.57","  0.27","  0.26"," -2.26"," -1.13","  0.15"," -2.78","  0.22"," -1.81"," -1.15","  0.98"," -1.63","  0.14"," -1.79"," -1.87"," -1.80","  0.13"," -2.20","  1.20","  0.23","  0.88","  0.95"," -1.78"," -1.08","  0.49"," -1.82","  0.50"," -0.83","  0.95","  1.00"," -1.85","  0.91","  1.23","  0.14","  0.90","  0.89","  0.13","  0.96"," -1.25"," -1.56","  0.88","  0.62"," -0.08","  1.17","  0.92","  0.65","  1.15","  0.13","  1.24","  1.27"," -0.84","  0.90","  1.32"," -1.32"," -0.77","  1.09","  1.04","  1.21","  0.28"," -0.87","  1.00","  0.95"," -0.83","  0.31","  0.87"," -3.19","  0.68","  0.90"," -1.32"," -0.52","  1.13","  1.05","  0.52","  0.35","  1.06","  0.20"," -0.95"," -0.96"," -0.74"," -0.74","  1.01","  0.49","  0.87","  1.08","  0.90","  1.24","  1.31","  1.24"," -0.94"],[" 12.70"," 11.96"," 16.00"," 15.68"," 14.05"," 15.21"," 14.93"," 13.10"," 12.37"," 14.58"," 10.64"," 11.94"," 14.28"," 14.62"," 11.09"," 14.41"," 11.93","  9.37"," 14.91","  9.54"," 13.92"," 11.22","  9.51"," 11.72"," 10.63"," 12.56"," 11.74"," 12.05"," 12.44"," 10.55"," 11.11"," 12.59"," 11.37"," 12.16"," 12.25"," 12.08"," 10.58"," 12.65"," 10.22"," 12.08"," 12.06","  8.37"," 12.18"," 11.18"," 11.75"," 11.50"," 12.92"," 11.82"," 12.84","  9.52","  8.10"," 12.29"," 11.11","  9.44"," 11.26"," 10.31"," 11.72"," 11.08"," 11.43"," 10.17"," 10.64"," 11.67"," 11.09"," 10.09"," 10.85"," 11.41"," 12.78"," 10.15"," 10.24"," 13.90"," 11.41"," 12.15"," 11.82"," 11.10"," 11.97"," 12.76"," 10.76"," 11.68"," 12.98"," 11.17","  9.37"," 11.41"," 11.67"," 12.61"," 13.54"," 10.65"," 10.84","  6.68","  7.65"," 10.13","  9.29"," 11.63"," 11.50"," 13.48"," 11.51","  9.50"," 10.43"," 10.06"," 10.22"," 11.87"],["5.87e-14","9.91e-14","1.11e-13","1.16e-13","1.59e-13","1.60e-13","1.84e-13","2.47e-13","2.92e-13","4.11e-13","7.07e-13","7.61e-13","8.09e-13","9.07e-13","9.18e-13","9.95e-13","1.00e-12","1.01e-12","1.05e-12","1.06e-12","1.11e-12","1.20e-12","1.21e-12","1.27e-12","1.42e-12","1.44e-12","1.51e-12","1.52e-12","1.56e-12","1.59e-12","1.69e-12","1.69e-12","1.72e-12","1.83e-12","1.84e-12","1.85e-12","1.86e-12","1.86e-12","1.87e-12","1.89e-12","1.92e-12","1.98e-12","1.99e-12","1.99e-12","1.99e-12","2.07e-12","2.13e-12","2.13e-12","2.19e-12","2.23e-12","2.27e-12","2.29e-12","2.37e-12","2.37e-12","2.40e-12","2.40e-12","2.42e-12","2.47e-12","2.48e-12","2.60e-12","2.71e-12","2.79e-12","2.81e-12","2.88e-12","2.88e-12","2.90e-12","2.93e-12","2.97e-12","3.07e-12","3.10e-12","3.11e-12","3.13e-12","3.21e-12","3.23e-12","3.24e-12","3.27e-12","3.34e-12","3.37e-12","3.39e-12","3.41e-12","3.41e-12","3.52e-12","3.57e-12","3.59e-12","3.62e-12","3.75e-12","3.77e-12","3.90e-12","3.92e-12","3.96e-12","3.96e-12","3.97e-12","4.14e-12","4.16e-12","4.17e-12","4.21e-12","4.27e-12","4.37e-12","4.43e-12","4.45e-12"],["5.50e-08","5.50e-08","5.50e-08","5.50e-08","5.50e-08","5.50e-08","5.50e-08","6.48e-08","6.81e-08","8.61e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.81e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.83e-08","8.93e-08","8.93e-08","8.93e-08","8.93e-08","9.06e-08","9.06e-08","9.06e-08","9.06e-08","9.06e-08","9.06e-08","9.06e-08","9.19e-08","9.19e-08","9.19e-08","9.19e-08","9.23e-08","9.33e-08","9.33e-08","9.33e-08"],["8.33e-07","8.33e-07","8.33e-07","8.33e-07","8.33e-07","8.33e-07","8.33e-07","9.81e-07","1.03e-06","1.30e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.33e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.34e-06","1.35e-06","1.35e-06","1.35e-06","1.35e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.39e-06","1.39e-06","1.39e-06","1.39e-06","1.40e-06","1.41e-06","1.41e-06","1.41e-06"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 11"</span>) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-12-1" class="level2">
<h2 class="anchored" data-anchor-id="k-12-1">k = 12</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k12topTable,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 12-mers."</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k12topTable, DE)),</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k12topTable),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cf58614879c1f8882ec5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cf58614879c1f8882ec5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 12-mers. 1229932 of 8390350 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["GAGAGTATAACC","CCGTTCCACGAC","CAACGTCGTGGA","CCCGTTCCACGA","GTTATACTCTCA","ATACTCTCAATC","ACGACGTTGGAT","AACGTCGTGGAA","CGTCGTGGAACG","CGCTACCAGAAA","GGACGTAGTCCA","TAGAGAAATCCA","CGTTGGATAGCA","CCGCCGGGTACC","CTTGTCCCCGGC","CACGACGTTGGA","CGAATAACGGAC","AATCACTGGTTA","ATTTCTGGTAGC","CCATGTGGCGTA","GTTGGATAGCAA","CAATGATTGAGA","TACTCTCAATCA","CCGGCCTCTGGC","ACGTCGTGGAAC","TTATACTCTCAA","AATCAGACGGCT","ACGTTGGATAGC","ATTTCTCTAGAA","GCTTGCTATCCA","AGCGAGCTCCCC","AGCTTGCTATCC","CGTGGAACGGGA","CGTCTTCTAGAG","ACAAGCTTGCTA","AGCAAGCTTGTC","AGCCAGAGGCCG","TCAATCATTGGA","TAGATATGGAAA","AAGCTTGCTATC","AAACGTGCGTCT","CCGTTATTCGTA","GGCCGGGGACAA","ATTCGCAAAAAG","ACGGCTGAAACC","GTGCGTCTTCTA","CCCAGTAATGGC","CCTGTATATTCC","CGAAGGGCTGAA","GACGTAGTCCAC","CGACGTTGGATA","AAGTGGTATCGC","ATCCAATGATTG","GGTTCGAGAGAC","GGTGTGGACTAC","ACAGCGAGCTCC","CGGCCCAGAACA","GAGCCCCCACGA","CTAGAAGACGCA","ATAGCAAGCTTG","GAGGCCGGGGAC","CACCATTCAATG","GAGCTCCCCGAC","CCCTGCGGCCCA","CAGCGAGCTCCC","CCAATGATTGAG","TGATTCTTATAA","AGGCCGGGGACA","CCCCGCTACCAG","AATAGCGATACC","ATTGAGAGTATA","ACTGGTTATACT","ACCAGTGATTAT","AAGCGGCCCTGC","CTGGGGAGGTAA","CGGCTGAAACCC","GCAAGCTTGTCC","CCAGTAATGGCC","ACGTCCTGTATA","CAGCCAGAGGCC","CTCAAAAGGGGC","TGTCGTACTGAA","GATCACAGCGAC","CGGGTACCCGGC","CGTTATTCGTAC","CCGTCGGGGAGC","AGCTCCCCGACG","AGTTGGGCACTC","CAACTCTTACGC","GCCGGTTCGTCA","GCGTTTACAACA","GGGGAAGGCGAC","GTAGGAATATAC","ACAGGACGTAGT","TCGTCGAGGTCA","CTTGACATAATC","GATATGGAAATC","AGAGGCCGGGGA","ATTACTGGGCAG","AGCGGCCCTGCA"],[" -2.15"," -2.10"," -2.11"," -2.12"," -2.10"," -1.91"," -2.01"," -2.14"," -2.14"," -0.97"," -1.98"," -1.74"," -1.22"," -3.42"," -1.23"," -2.10"," -4.02"," -2.22"," -1.07"," -3.13"," -1.11"," -1.74"," -1.99"," -1.25"," -2.17"," -1.76"," -2.37"," -1.23"," -1.39"," -1.21","  0.16"," -1.22"," -1.77"," -1.87"," -1.24"," -1.06"," -1.18"," -1.79"," -0.81"," -1.15"," -2.19"," -3.96"," -1.24"," -1.52"," -2.42"," -2.17"," -1.60"," -1.16"," -3.04"," -1.98"," -2.03"," -2.98"," -1.80"," -3.22"," -1.74","  0.18"," -2.12"," -3.75"," -1.95"," -1.16"," -1.09"," -1.34","  0.16"," -2.66","  0.20"," -1.83"," -2.08"," -1.25"," -3.11"," -2.96"," -1.78"," -1.67"," -2.13"," -3.02"," -1.64"," -2.56"," -1.09"," -1.57"," -1.82"," -1.02"," -2.39"," -1.15"," -2.19"," -3.24"," -4.12","  0.19","  0.15"," -3.01"," -3.27"," -4.46"," -1.78"," -2.51"," -1.31"," -2.06"," -3.26"," -2.18"," -0.81"," -1.15"," -1.76"," -3.20"],[" 13.86"," 16.44"," 16.29"," 16.82"," 14.01"," 11.13"," 17.11"," 17.25"," 17.31"," 15.19"," 14.83"," 11.75"," 16.40"," 15.04"," 16.37"," 17.22","-11.42"," 10.51"," 17.32"," 15.34"," 14.19"," 12.04"," 11.03"," 15.90"," 17.99"," 10.21"," 11.82"," 16.33"," 10.12"," 15.70"," 13.10"," 16.14"," 13.10"," 12.02"," 15.64"," 13.47"," 14.42"," 14.21"," 14.09"," 13.96"," 14.91","-11.25"," 16.52"," 15.15"," 12.29"," 15.12"," 13.39"," 13.14"," 12.61"," 16.63"," 17.71"," 11.38"," 14.34"," 15.02"," 12.89"," 13.09"," 13.67","-12.69"," 12.64"," 14.31"," 13.47"," 10.68"," 14.60"," 13.04"," 12.24"," 14.80","  9.18"," 16.17"," 15.09"," 11.06"," 11.26"," 11.59","  9.71"," 15.33"," 13.02"," 13.55"," 13.93"," 13.50"," 12.32"," 12.82","  9.41"," 13.47"," 15.39"," 14.68","-11.30"," 15.32"," 15.38"," 14.16"," 12.43","-16.49"," 11.54"," 12.49"," 15.09"," 16.47","-11.26","  9.05"," 14.25"," 15.28"," 11.14"," 12.12"],["2.33e-14","3.15e-14","4.17e-14","4.65e-14","5.78e-14","7.02e-14","7.76e-14","7.90e-14","1.04e-13","1.56e-13","1.75e-13","1.80e-13","1.92e-13","1.92e-13","1.92e-13","2.21e-13","2.32e-13","2.32e-13","2.37e-13","2.45e-13","2.78e-13","2.90e-13","2.91e-13","3.08e-13","3.11e-13","3.14e-13","3.25e-13","3.55e-13","3.64e-13","3.70e-13","3.74e-13","3.98e-13","4.27e-13","4.48e-13","4.49e-13","4.50e-13","4.67e-13","5.17e-13","5.22e-13","5.54e-13","5.85e-13","6.04e-13","6.42e-13","6.61e-13","6.82e-13","6.89e-13","6.91e-13","6.92e-13","6.99e-13","7.32e-13","7.63e-13","7.65e-13","7.71e-13","8.10e-13","8.46e-13","8.51e-13","8.76e-13","8.93e-13","8.98e-13","9.07e-13","9.40e-13","9.64e-13","9.69e-13","9.87e-13","1.02e-12","1.07e-12","1.07e-12","1.09e-12","1.11e-12","1.11e-12","1.11e-12","1.14e-12","1.16e-12","1.17e-12","1.18e-12","1.27e-12","1.31e-12","1.32e-12","1.33e-12","1.34e-12","1.34e-12","1.35e-12","1.42e-12","1.48e-12","1.56e-12","1.56e-12","1.58e-12","1.59e-12","1.61e-12","1.61e-12","1.62e-12","1.64e-12","1.66e-12","1.70e-12","1.77e-12","1.82e-12","1.82e-12","1.83e-12","1.86e-12","1.89e-12"],["8.28e-08","8.28e-08","8.28e-08","8.28e-08","8.28e-08","8.28e-08","8.28e-08","8.28e-08","9.70e-08","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.01e-07","1.04e-07","1.05e-07","1.05e-07","1.05e-07","1.05e-07","1.06e-07","1.12e-07","1.12e-07","1.16e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.20e-07","1.22e-07","1.22e-07","1.22e-07","1.22e-07","1.26e-07","1.27e-07","1.27e-07","1.27e-07","1.27e-07","1.27e-07","1.27e-07","1.29e-07","1.29e-07","1.29e-07","1.29e-07","1.31e-07","1.31e-07","1.31e-07","1.31e-07","1.31e-07","1.31e-07","1.31e-07","1.32e-07","1.32e-07","1.32e-07","1.32e-07","1.38e-07","1.38e-07","1.38e-07","1.38e-07","1.38e-07","1.38e-07","1.38e-07","1.44e-07","1.47e-07","1.49e-07","1.49e-07","1.49e-07","1.49e-07","1.49e-07","1.49e-07","1.49e-07","1.50e-07","1.50e-07","1.52e-07","1.52e-07","1.52e-07","1.52e-07","1.52e-07","1.52e-07","1.52e-07"],["1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.37e-06","1.60e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.67e-06","1.72e-06","1.73e-06","1.73e-06","1.73e-06","1.73e-06","1.75e-06","1.85e-06","1.85e-06","1.92e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","1.98e-06","2.02e-06","2.02e-06","2.02e-06","2.02e-06","2.08e-06","2.10e-06","2.10e-06","2.10e-06","2.10e-06","2.10e-06","2.10e-06","2.13e-06","2.13e-06","2.13e-06","2.14e-06","2.17e-06","2.17e-06","2.17e-06","2.17e-06","2.17e-06","2.17e-06","2.17e-06","2.19e-06","2.19e-06","2.19e-06","2.19e-06","2.29e-06","2.29e-06","2.29e-06","2.29e-06","2.29e-06","2.29e-06","2.29e-06","2.37e-06","2.44e-06","2.47e-06","2.47e-06","2.47e-06","2.47e-06","2.47e-06","2.47e-06","2.47e-06","2.48e-06","2.48e-06","2.51e-06","2.51e-06","2.51e-06","2.51e-06","2.51e-06","2.51e-06","2.51e-06"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 12"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 11"</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data-export" class="level1">
<h1>Data export</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k5counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k5counts.Rds"</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k6counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k6counts.Rds"</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k7counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k7counts.Rds"</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k8counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k8counts.Rds"</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k9counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k9counts.Rds"</span>))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k10counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k10counts.Rds"</span>))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k11counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k11counts.Rds"</span>))</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k12counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k12counts.Rds"</span>))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k5topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k5topTable.Rds"</span>))</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k6topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k6topTable.Rds"</span>))</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k7topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k7topTable.Rds"</span>))</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k8topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k8topTable.Rds"</span>))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k9topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k9topTable.Rds"</span>))</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k10topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k10topTable.Rds"</span>))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k11topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k11topTable.Rds"</span>))</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k12topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k12topTable.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.0 (2025-04-11)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Australia/Adelaide
tzcode source: system (glibc)

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ggdendro_0.2.0   pheatmap_1.0.12  ggrepel_0.9.6    DT_0.33         
 [5] edgeR_4.6.0      limma_3.64.0     kableExtra_1.4.0 ggpubr_0.6.0    
 [9] scales_1.3.0     here_1.0.1       pander_0.6.6     magrittr_2.0.3  
[13] lubridate_1.9.4  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     
[17] purrr_1.0.4      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    
[21] ggplot2_3.5.2    tidyverse_2.0.0 

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1   viridisLite_0.4.2  farver_2.1.2       fastmap_1.2.0     
 [5] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    statmod_1.5.0     
 [9] compiler_4.5.0     rlang_1.1.6        sass_0.4.10        tools_4.5.0       
[13] yaml_2.3.10        knitr_1.50         ggsignif_0.6.4     labeling_0.4.3    
[17] htmlwidgets_1.6.4  bit_4.6.0          xml2_1.3.8         RColorBrewer_1.1-3
[21] abind_1.4-8        withr_3.0.2        grid_4.5.0         colorspace_2.1-1  
[25] MASS_7.3-65        cli_3.6.4          rmarkdown_2.29     crayon_1.5.3      
[29] generics_0.1.3     rstudioapi_0.17.1  tzdb_0.5.0         cachem_1.1.0      
[33] splines_4.5.0      vctrs_0.6.5        jsonlite_2.0.0     carData_3.0-5     
[37] car_3.1-3          hms_1.1.3          bit64_4.6.0-1      rstatix_0.7.2     
[41] Formula_1.2-5      systemfonts_1.2.2  crosstalk_1.2.1    locfit_1.5-9.12   
[45] jquerylib_0.1.4    glue_1.8.0         cowplot_1.1.3      stringi_1.8.7     
[49] gtable_0.3.6       munsell_0.5.1      pillar_1.10.2      htmltools_0.5.8.1 
[53] R6_2.6.1           rprojroot_2.0.4    vroom_1.6.5        evaluate_1.0.3    
[57] lattice_0.22-7     backports_1.5.0    broom_1.0.8        bslib_0.9.0       
[61] Rcpp_1.0.14        svglite_2.1.3      gridExtra_2.3      xfun_0.52         
[65] pkgconfig_2.0.3   </code></pre>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>