<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lachlan Baer">

<title>rRNADepletion_s4ter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-474c6d7e63be50eb6972897072b39b27.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9f253fc715695556361a9d609d1163b1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-6957ea37afea8e4d348ff04dd501af60.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./kmer.html">k-mer</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">rRNADepletion_s4ter</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/baerlachlan/241107_THOC_Raman" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./qc_rRNA_removed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">QC (rRNA removed)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./de.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DGE</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmer.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">k-mer</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data">Load data</a></li>
  <li><a href="#k-mer-analysis" id="toc-k-mer-analysis" class="nav-link" data-scroll-target="#k-mer-analysis">k-mer analysis</a>
  <ul>
  <li><a href="#k-5" id="toc-k-5" class="nav-link" data-scroll-target="#k-5">k = 5</a>
  <ul>
  <li><a href="#counts" id="toc-counts" class="nav-link" data-scroll-target="#counts">Counts</a></li>
  <li><a href="#properties" id="toc-properties" class="nav-link" data-scroll-target="#properties">Properties</a></li>
  <li><a href="#differential-expression" id="toc-differential-expression" class="nav-link" data-scroll-target="#differential-expression">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-6" id="toc-k-6" class="nav-link" data-scroll-target="#k-6">k = 6</a>
  <ul>
  <li><a href="#counts-1" id="toc-counts-1" class="nav-link" data-scroll-target="#counts-1">Counts</a></li>
  <li><a href="#properties-1" id="toc-properties-1" class="nav-link" data-scroll-target="#properties-1">Properties</a></li>
  <li><a href="#differential-expression-1" id="toc-differential-expression-1" class="nav-link" data-scroll-target="#differential-expression-1">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-7" id="toc-k-7" class="nav-link" data-scroll-target="#k-7">k = 7</a>
  <ul>
  <li><a href="#counts-2" id="toc-counts-2" class="nav-link" data-scroll-target="#counts-2">Counts</a></li>
  <li><a href="#properties-2" id="toc-properties-2" class="nav-link" data-scroll-target="#properties-2">Properties</a></li>
  <li><a href="#differential-expression-2" id="toc-differential-expression-2" class="nav-link" data-scroll-target="#differential-expression-2">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-8" id="toc-k-8" class="nav-link" data-scroll-target="#k-8">k = 8</a>
  <ul>
  <li><a href="#counts-3" id="toc-counts-3" class="nav-link" data-scroll-target="#counts-3">Counts</a></li>
  <li><a href="#properties-3" id="toc-properties-3" class="nav-link" data-scroll-target="#properties-3">Properties</a></li>
  <li><a href="#differential-expression-3" id="toc-differential-expression-3" class="nav-link" data-scroll-target="#differential-expression-3">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-9" id="toc-k-9" class="nav-link" data-scroll-target="#k-9">k = 9</a>
  <ul>
  <li><a href="#counts-4" id="toc-counts-4" class="nav-link" data-scroll-target="#counts-4">Counts</a></li>
  <li><a href="#properties-4" id="toc-properties-4" class="nav-link" data-scroll-target="#properties-4">Properties</a></li>
  <li><a href="#differential-expression-4" id="toc-differential-expression-4" class="nav-link" data-scroll-target="#differential-expression-4">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-10" id="toc-k-10" class="nav-link" data-scroll-target="#k-10">k = 10</a>
  <ul>
  <li><a href="#counts-5" id="toc-counts-5" class="nav-link" data-scroll-target="#counts-5">Counts</a></li>
  <li><a href="#properties-5" id="toc-properties-5" class="nav-link" data-scroll-target="#properties-5">Properties</a></li>
  <li><a href="#differential-expression-5" id="toc-differential-expression-5" class="nav-link" data-scroll-target="#differential-expression-5">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-11" id="toc-k-11" class="nav-link" data-scroll-target="#k-11">k = 11</a>
  <ul>
  <li><a href="#counts-6" id="toc-counts-6" class="nav-link" data-scroll-target="#counts-6">Counts</a></li>
  <li><a href="#properties-6" id="toc-properties-6" class="nav-link" data-scroll-target="#properties-6">Properties</a></li>
  <li><a href="#differential-expression-6" id="toc-differential-expression-6" class="nav-link" data-scroll-target="#differential-expression-6">Differential expression</a></li>
  </ul></li>
  <li><a href="#k-12" id="toc-k-12" class="nav-link" data-scroll-target="#k-12">k = 12</a>
  <ul>
  <li><a href="#counts-7" id="toc-counts-7" class="nav-link" data-scroll-target="#counts-7">Counts</a></li>
  <li><a href="#properties-7" id="toc-properties-7" class="nav-link" data-scroll-target="#properties-7">Properties</a></li>
  <li><a href="#differential-expression-7" id="toc-differential-expression-7" class="nav-link" data-scroll-target="#differential-expression-7">Differential expression</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#distributions" id="toc-distributions" class="nav-link" data-scroll-target="#distributions">Distributions</a></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#differential-expression-8" id="toc-differential-expression-8" class="nav-link" data-scroll-target="#differential-expression-8">Differential expression</a>
  <ul>
  <li><a href="#k-5-1" id="toc-k-5-1" class="nav-link" data-scroll-target="#k-5-1">k = 5</a></li>
  <li><a href="#k-6-1" id="toc-k-6-1" class="nav-link" data-scroll-target="#k-6-1">k = 6</a></li>
  <li><a href="#k-7-1" id="toc-k-7-1" class="nav-link" data-scroll-target="#k-7-1">k = 7</a></li>
  <li><a href="#k-8-1" id="toc-k-8-1" class="nav-link" data-scroll-target="#k-8-1">k = 8</a></li>
  <li><a href="#k-9-1" id="toc-k-9-1" class="nav-link" data-scroll-target="#k-9-1">k = 9</a></li>
  <li><a href="#k-10-1" id="toc-k-10-1" class="nav-link" data-scroll-target="#k-10-1">k = 10</a></li>
  <li><a href="#k-11-1" id="toc-k-11-1" class="nav-link" data-scroll-target="#k-11-1">k = 11</a></li>
  <li><a href="#k-12-1" id="toc-k-12-1" class="nav-link" data-scroll-target="#k-12-1">k = 12</a></li>
  </ul></li>
  <li><a href="#data-export" id="toc-data-export" class="nav-link" data-scroll-target="#data-export">Data export</a></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">rRNADepletion_s4ter</h1>
<p class="subtitle lead">k-mer analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lachlan Baer </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">LAST MODIFIED</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">19 December, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(edgeR)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdendro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">interactive</span>()) <span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>())</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     here::here("1_Psen2S4Ter/R/output/1_1_DE.RData")</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-data" class="level1">
<h1>Load data</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>addInfo <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/addInfo.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-mer-analysis" class="level1">
<h1>k-mer analysis</h1>
<p><code>jellyfish v2.3.0</code> was used to count kmers of trimmed <code>fastq</code> files that had been filtered for rRNA sequences. This was performed for 5 values: <span class="math inline">\(k = 5, 6, 7, 8, 9, 10\)</span>. Lower values of <span class="math inline">\(k\)</span> lose specificity in comparison to higher values, however as <span class="math inline">\(k\)</span> increases, the exponential increase of possible kmers causes limitations due to computational processing time.</p>
<section id="k-5" class="level2">
<h2 class="anchored" data-anchor-id="k-5">k = 5</h2>
<section id="counts" class="level3">
<h3 class="anchored" data-anchor-id="counts">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>k5files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k5"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>k5counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k5files, <span class="cf">function</span>(x){</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>k5dge <span class="ot">&lt;-</span> k5counts <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>k5dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>k5dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k5dge) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties" class="level3">
<h3 class="anchored" data-anchor-id="properties">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>k5dist <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 5-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>k5labels <span class="ot">&lt;-</span> k5dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>k5heat <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"5-mer counts heatmap"</span>, <span class="at">labels_row =</span> k5labels)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>k5heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k5labels</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>k5den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k5heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 5-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>k5pca <span class="ot">&lt;-</span> k5dge <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>k5pcaPlot <span class="ot">&lt;-</span> k5pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k5dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 5"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>k5pcaRrna <span class="ot">&lt;-</span> k5pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k5dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k5pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 5"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>k5design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k5dge<span class="sc">$</span>samples)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>k5disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k5dge, k5design)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>k5fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k5disp)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k5fit) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-6" class="level2">
<h2 class="anchored" data-anchor-id="k-6">k = 6</h2>
<section id="counts-1" class="level3">
<h3 class="anchored" data-anchor-id="counts-1">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>k6files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k6"</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>k6counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k6files, <span class="cf">function</span>(x){</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>k6dge <span class="ot">&lt;-</span> k6counts <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>k6dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>k6dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k6dge) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-1" class="level3">
<h3 class="anchored" data-anchor-id="properties-1">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>k6dist <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 6-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>k6labels <span class="ot">&lt;-</span> k6dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>k6heat <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"6-mer counts heatmap"</span>, <span class="at">labels_row =</span> k6labels)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>k6heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k6labels</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>k6den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k6heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 6-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>k6pca <span class="ot">&lt;-</span> k6dge <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>k6pcaPlot <span class="ot">&lt;-</span> k6pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k6dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 6"</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k6pcaRrna <span class="ot">&lt;-</span> k6pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k6dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k6pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 6"</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-1" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-1">Differential expression</h3>
<!-- ```{r k6DE} -->
<!-- k6design <- model.matrix(~rRNA, data = k6dge$samples) -->
<!-- k6voom <- voom(k6dge, design = k6design) -->
<!-- k6fit <- lmFit(k6voom, design = k6design) -->
<!-- k6eBayes <- eBayes(k6fit) -->
<!-- ``` -->
<!-- ```{r k6topTable} -->
<!-- k6topTable <- k6eBayes %>% -->
<!--     topTable(coef = colnames(k6design)[2], sort.by = "p", n = Inf) %>% -->
<!--     set_colnames(str_remove(colnames(.), "ID\\.")) %>% -->
<!--     rownames_to_column("mer") %>% -->
<!--     mutate(BY = p.adjust(P.Value, "BY")) %>% -->
<!--     mutate(DE = BY < 0.05) %>% -->
<!--     dplyr::select( -->
<!--         mer, -->
<!--         AveExpr, -->
<!--         logFC, -->
<!--         P.Value, -->
<!--         FDR = adj.P.Val, -->
<!--         BY, -->
<!--         t, -->
<!--         DE, -->
<!--         everything(), -->
<!--         -B -->
<!--     ) %>% -->
<!--     as_tibble() -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>k6design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k6dge<span class="sc">$</span>samples)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>k6disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k6dge, k6design)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>k6fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k6disp)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k6fit) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-7" class="level2">
<h2 class="anchored" data-anchor-id="k-7">k = 7</h2>
<section id="counts-2" class="level3">
<h3 class="anchored" data-anchor-id="counts-2">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>k7files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k7"</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>k7counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k7files, <span class="cf">function</span>(x){</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>k7dge <span class="ot">&lt;-</span> k7counts <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>k7dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>k7dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k7dge) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-2" class="level3">
<h3 class="anchored" data-anchor-id="properties-2">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>k7dist <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 7-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>k7labels <span class="ot">&lt;-</span> k7dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>k7heat <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"7-mer counts heatmap"</span>, <span class="at">labels_row =</span> k7labels)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>k7heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k7labels</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>k7den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k7heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 7-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>k7pca <span class="ot">&lt;-</span> k7dge <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>k7pcaPlot <span class="ot">&lt;-</span> k7pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k7dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 7"</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>k7pcaRrna <span class="ot">&lt;-</span> k7pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k7dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k7pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 7"</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-2" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-2">Differential expression</h3>
<!-- ```{r k7DE} -->
<!-- k7design <- model.matrix(~rRNA, data = k7dge$samples) -->
<!-- k7voom <- voom(k7dge, design = k7design) -->
<!-- k7fit <- lmFit(k7voom, design = k7design) -->
<!-- k7eBayes <- eBayes(k7fit) -->
<!-- ``` -->
<!-- ```{r k7topTable} -->
<!-- k7topTable <- k7eBayes %>% -->
<!--     topTable(coef = colnames(k7design)[2], sort.by = "p", n = Inf) %>% -->
<!--     set_colnames(str_remove(colnames(.), "ID\\.")) %>% -->
<!--     rownames_to_column("mer") %>% -->
<!--     mutate(BY = p.adjust(P.Value, "BY")) %>% -->
<!--     mutate(DE = BY < 0.05) %>% -->
<!--     dplyr::select( -->
<!--         mer, -->
<!--         AveExpr, -->
<!--         logFC, -->
<!--         P.Value, -->
<!--         FDR = adj.P.Val, -->
<!--         BY, -->
<!--         t, -->
<!--         DE, -->
<!--         everything(), -->
<!--         -B -->
<!--     ) %>% -->
<!--     as_tibble() -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>k7design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k7dge<span class="sc">$</span>samples)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>k7disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k7dge, k7design)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>k7fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k7disp)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k7fit) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-8" class="level2">
<h2 class="anchored" data-anchor-id="k-8">k = 8</h2>
<section id="counts-3" class="level3">
<h3 class="anchored" data-anchor-id="counts-3">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>k8files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k8"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>k8counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k8files, <span class="cf">function</span>(x){</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>k8dge <span class="ot">&lt;-</span> k8counts <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>k8dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>k8dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k8dge) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-3" class="level3">
<h3 class="anchored" data-anchor-id="properties-3">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>k8dist <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 8-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>k8labels <span class="ot">&lt;-</span> k8dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>k8heat <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"8-mer counts heatmap"</span>, <span class="at">labels_row =</span> k8labels)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>k8heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k8labels</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>k8den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k8heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 8-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>k8pca <span class="ot">&lt;-</span> k8dge <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>k8pcaPlot <span class="ot">&lt;-</span> k8pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k8dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 8"</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>k8pcaRrna <span class="ot">&lt;-</span> k8pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k8dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k8pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 8"</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-3" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-3">Differential expression</h3>
<!-- ```{r k8DE} -->
<!-- k8design <- model.matrix(~rRNA, data = k8dge$samples) -->
<!-- k8voom <- voom(k8dge, design = k8design) -->
<!-- k8fit <- lmFit(k8voom, design = k8design) -->
<!-- k8eBayes <- eBayes(k8fit) -->
<!-- ``` -->
<!-- ```{r k8topTable} -->
<!-- k8topTable <- k8eBayes %>% -->
<!--     topTable(coef = colnames(k8design)[2], sort.by = "p", n = Inf) %>% -->
<!--     set_colnames(str_remove(colnames(.), "ID\\.")) %>% -->
<!--     rownames_to_column("mer") %>% -->
<!--     mutate(BY = p.adjust(P.Value, "BY")) %>% -->
<!--     mutate(DE = BY < 0.05) %>% -->
<!--     dplyr::select( -->
<!--         mer, -->
<!--         AveExpr, -->
<!--         logFC, -->
<!--         P.Value, -->
<!--         FDR = adj.P.Val, -->
<!--         BY, -->
<!--         t, -->
<!--         DE, -->
<!--         everything(), -->
<!--         -B -->
<!--     ) %>% -->
<!--     as_tibble() -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k8design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k8dge<span class="sc">$</span>samples)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>k8disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k8dge, k8design)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>k8fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k8disp)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k8fit) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-9" class="level2">
<h2 class="anchored" data-anchor-id="k-9">k = 9</h2>
<section id="counts-4" class="level3">
<h3 class="anchored" data-anchor-id="counts-4">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>k9files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k9"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>k9counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k9files, <span class="cf">function</span>(x){</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>k9dge <span class="ot">&lt;-</span> k9counts <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>k9dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>k9dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k9dge) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-4" class="level3">
<h3 class="anchored" data-anchor-id="properties-4">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>k9dist <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 9-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>k9labels <span class="ot">&lt;-</span> k9dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>k9heat <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"9-mer counts heatmap"</span>, <span class="at">labels_row =</span> k9labels)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>k9heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k9labels</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>k9den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k9heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 9-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>k9pca <span class="ot">&lt;-</span> k9dge <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>k9pcaPlot <span class="ot">&lt;-</span> k9pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k9dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 9"</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>k9pcaRrna <span class="ot">&lt;-</span> k9pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k9dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k9pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 9"</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-4" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-4">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>k9design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k9dge<span class="sc">$</span>samples)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>k9disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k9dge, k9design)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>k9fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k9disp)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k9fit) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-10" class="level2">
<h2 class="anchored" data-anchor-id="k-10">k = 10</h2>
<section id="counts-5" class="level3">
<h3 class="anchored" data-anchor-id="counts-5">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>k10files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k10"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>k10counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k10files, <span class="cf">function</span>(x){</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>k10dge <span class="ot">&lt;-</span> k10counts <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>k10dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>k10dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k10dge) <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-5" class="level3">
<h3 class="anchored" data-anchor-id="properties-5">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>k10dist <span class="ot">&lt;-</span> k10dge <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 10-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>k10labels <span class="ot">&lt;-</span> k10dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>k10heat <span class="ot">&lt;-</span> k10dge <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"10-mer counts heatmap"</span>, <span class="at">labels_row =</span> k10labels)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>k10heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k10labels</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>k10den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k10heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 10-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>k10pca <span class="ot">&lt;-</span> k10dge <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>k10pcaPlot <span class="ot">&lt;-</span> k10pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k10dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 10"</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>k10pcaRrna <span class="ot">&lt;-</span> k10pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k10dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k10pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 10"</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-5" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-5">Differential expression</h3>
<!-- ```{r k10DE} -->
<!-- k10design <- model.matrix(~rRNA, data = k10dge$samples) -->
<!-- k10voom <- voom(k10dge, design = k10design) -->
<!-- k10fit <- lmFit(k10voom, design = k10design) -->
<!-- k10eBayes <- eBayes(k10fit) -->
<!-- ``` -->
<!-- ```{r k10topTable} -->
<!-- k10topTable <- k10eBayes %>% -->
<!--     topTable(coef = colnames(k10design)[2], sort.by = "p", n = Inf) %>% -->
<!--     set_colnames(str_remove(colnames(.), "ID\\.")) %>% -->
<!--     rownames_to_column("mer") %>% -->
<!--     mutate(BY = p.adjust(P.Value, "BY")) %>% -->
<!--     mutate(DE = BY < 0.05) %>% -->
<!--     dplyr::select( -->
<!--         mer, -->
<!--         AveExpr, -->
<!--         logFC, -->
<!--         P.Value, -->
<!--         FDR = adj.P.Val, -->
<!--         BY, -->
<!--         t, -->
<!--         DE, -->
<!--         everything(), -->
<!--         -B -->
<!--     ) %>% -->
<!--     as_tibble() -->
<!-- ``` -->
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>k10design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k10dge<span class="sc">$</span>samples)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>k10disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k10dge, k10design)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>k10fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k10disp)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k10fit) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-11" class="level2">
<h2 class="anchored" data-anchor-id="k-11">k = 11</h2>
<section id="counts-6" class="level3">
<h3 class="anchored" data-anchor-id="counts-6">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>k11files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k11"</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>k11counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k11files, <span class="cf">function</span>(x){</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>k11dge <span class="ot">&lt;-</span> k11counts <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>k11dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>k11dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k11dge) <span class="sc">%&gt;%</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-6" class="level3">
<h3 class="anchored" data-anchor-id="properties-6">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>k11dist <span class="ot">&lt;-</span> k11dge <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 11-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>k11labels <span class="ot">&lt;-</span> k11dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>k11heat <span class="ot">&lt;-</span> k11dge <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"11-mer counts heatmap"</span>, <span class="at">labels_row =</span> k11labels)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>k11heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k11labels</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>k11den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k11heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 11-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>k11pca <span class="ot">&lt;-</span> k11dge <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>k11pcaPlot <span class="ot">&lt;-</span> k11pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k11dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 11"</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>k11pcaRrna <span class="ot">&lt;-</span> k11pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k11dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k11pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 11"</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-6" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-6">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>k11design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k11dge<span class="sc">$</span>samples)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>k11disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k11dge, k11design)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>k11fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k11disp)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k11fit) <span class="sc">%&gt;%</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="k-12" class="level2">
<h2 class="anchored" data-anchor-id="k-12">k = 12</h2>
<section id="counts-7" class="level3">
<h3 class="anchored" data-anchor-id="counts-7">Counts</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>k12files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"/mnt/hpcfs/a1647910/20200310_rRNADepletion/1_Psen2S4Ter/analysis-kmer/results/jellyfish/k12"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">".dumps"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>k12counts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(k12files, <span class="cf">function</span>(x){</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_delim</span>(x, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"mer"</span>, <span class="fu">basename</span>(x)), <span class="at">delim =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">set_colnames</span>(<span class="fu">str_remove_all</span>(<span class="fu">colnames</span>(.), <span class="st">"_6month_.+_F3|[0-9]*_Ps2Ex3M1_|</span><span class="sc">\\</span><span class="st">.dumps"</span>))</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(mer, <span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>k12dge <span class="ot">&lt;-</span> k12counts <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DGEList</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">calcNormFactors</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>k12dge<span class="sc">$</span>samples <span class="sc">%&lt;&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"rowname"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sample =</span> rowname) <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(addInfo) <span class="sc">%&gt;%</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="st">"rowname"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>k12dge<span class="sc">$</span>samples<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">colnames</span>(k12dge) <span class="sc">%&gt;%</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">"(WT|Heter)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"Heter"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="properties-7" class="level3">
<h3 class="anchored" data-anchor-id="properties-7">Properties</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>k12dist <span class="ot">&lt;-</span> k12dge <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"sample"</span>, <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">colour =</span> sample)) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"intensity"</span>, <span class="at">title =</span> <span class="st">"Distribution of 12-mers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>k12labels <span class="ot">&lt;-</span> k12dge<span class="sc">$</span>samples <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">paste0</span>(sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">percent</span>(rRNA, <span class="at">accuracy =</span> <span class="fl">0.01</span>), <span class="st">" rRNA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    .<span class="sc">$</span>label</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>k12heat <span class="ot">&lt;-</span> k12dge <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pheatmap</span>(<span class="at">silent =</span> <span class="cn">TRUE</span>, <span class="at">cluster_cols =</span> <span class="cn">FALSE</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">fontsize =</span> <span class="dv">9</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">border_color =</span> <span class="cn">NA</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">main =</span> <span class="st">"12-mer counts heatmap"</span>, <span class="at">labels_row =</span> k12labels)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>k12heat<span class="sc">$</span>tree_row<span class="sc">$</span>labels <span class="ot">&lt;-</span> k12labels</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>k12den <span class="ot">&lt;-</span> <span class="fu">ggdendrogram</span>(k12heat<span class="sc">$</span>tree_row, <span class="at">rotate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hierarchical clustering of 12-mer counts"</span>) <span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess cpm values to make sure PCA results are not heavily skewed by highly expressed genes</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>k12pca <span class="ot">&lt;-</span> k12dge <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cpm</span>(<span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prcomp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick inspection to check whether first two PCA components capture most of the variability</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance <span class="sc">%&gt;%</span> <span class="fu">pander</span>(<span class="at">split.tables =</span> <span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot PCA</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>k12pcaPlot <span class="ot">&lt;-</span> k12pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k12dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, PC2, <span class="at">colour =</span> group, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC2"</span>]), <span class="st">")"</span>),</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 12"</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>k12pcaRrna <span class="ot">&lt;-</span> k12pca<span class="sc">$</span>x <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"sample"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(sample, PC1, PC2) <span class="sc">%&gt;%</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(k12dge<span class="sc">$</span>samples) <span class="sc">%&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(PC1, rRNA, <span class="at">label =</span> rRNA)) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> group), <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, <span class="fu">percent</span>(<span class="fu">summary</span>(k12pca)<span class="sc">$</span>importance[<span class="dv">2</span>, <span class="st">"PC1"</span>]), <span class="st">")"</span>),</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"rRNA proportion"</span>,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"Genotype"</span>,</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"k = 12"</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent) <span class="sc">+</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wildtype"</span>, <span class="st">"Mutant"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="differential-expression-7" class="level3">
<h3 class="anchored" data-anchor-id="differential-expression-7">Differential expression</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>k12design <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>rRNA, <span class="at">data =</span> k12dge<span class="sc">$</span>samples)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>k12disp <span class="ot">&lt;-</span> <span class="fu">estimateDisp</span>(k12dge, k12design)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>k12fit <span class="ot">&lt;-</span> <span class="fu">glmQLFit</span>(k12disp)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="ot">&lt;-</span> <span class="fu">glmQLFTest</span>(k12fit) <span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">topTags</span>(<span class="at">n =</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    .[[<span class="st">"table"</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">"mer"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>        mer,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>        logFC,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>        logCPM,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>        F,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">P.Value =</span> PValue,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>        FDR,</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">BY =</span> <span class="fu">p.adjust</span>(P.Value, <span class="st">"BY"</span>),</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">DE =</span> BY <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="distributions" class="level1">
<h1>Distributions</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>    k5dist, k6dist, k7dist, k8dist, k9dist, k10dist, k11dist, k12dist,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/allDists-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Distributions of kmer counts for each value of <span class="math inline">\(k\)</span></em></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="pca" class="level1">
<h1>PCA</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    k5pcaPlot, k6pcaPlot, k7pcaPlot, k8pcaPlot, k9pcaPlot, k10pcaPlot, k11pcaPlot, k12pcaPlot,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/allPcas-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Principal component analysis for all values of <span class="math inline">\(k\)</span>. As <span class="math inline">\(k\)</span> increases, WT and mutant groups start to separate.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    k5pcaRrna, k6pcaRrna, k7pcaRrna, k8pcaRrna, k9pcaRrna, k10pcaRrna, k11pcaRrna, k12pcaRrna,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/allPcaRrnas-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Principal component analysis for all values of <span class="math inline">\(k\)</span>. As <span class="math inline">\(k\)</span> increases, WT and mutant groups start to separate.</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="clustering" class="level1">
<h1>Clustering</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    k5den, k6den, k7den, k8den, k9den, k10den, k11den, k12den,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/allDens-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Hierarchical clustering of samples based on kmer counts. As <span class="math inline">\(k\)</span> increases, WT and mutant groups start to cluster.</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="differential-expression-8" class="level1">
<h1>Differential expression</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>topRes <span class="ot">&lt;-</span> <span class="cf">function</span>(x, cap){</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(mer, logCPM, logFC, P.Value, FDR, BY, DE) <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">logCPM =</span> <span class="fu">format</span>(<span class="fu">round</span>(logCPM, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>),</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">logFC =</span> <span class="fu">format</span>(<span class="fu">round</span>(logFC, <span class="dv">2</span>), <span class="at">nsmall =</span> <span class="dv">2</span>),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">P.Value =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, P.Value),</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">FDR =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, FDR),</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">BY =</span> <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, BY)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">datatable</span>(</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>),</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">class =</span> <span class="st">"striped hover condensed responsive"</span>,</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">caption =</span> cap</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="k-5-1" class="level2">
<h2 class="anchored" data-anchor-id="k-5-1">k = 5</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k5topTable,</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 5-mers."</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k5topTable, DE)),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k5topTable),</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with BY p-value &lt; 0.05."</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f2f55e62fc27209083f5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f2f55e62fc27209083f5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 5-mers. 88 of 512 detected sequences were classified as DE with BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["AGAGA","GAGAA","GTCAA","CAGCA","GTCTA","ATGGA","CACTA","AGTAG","CCAAC","AAGAG","CATCC","GATGA","ACTAC","CACAC","GTGAA","AGATG","GACTA","CTGAC","CTGGA","CAGTA","CTAAG","CCTTA","ATGGG","AGGAA","TACCA","ATCCA","CCATC","TCCAA","CATCA","ACACA","AGGAT","CAACC","GTTCA","CTTGA","GCATA","AGCTG","GCAAC","GACTC","AGGTC","AGATC","GGATA","ATGAG","GACCA","CTCTC","AGGCA","CACTC","ACGCA","GCCAA","GATCA","GAAGA","ATACC","GGCCA","AGTGC","CAGAG","ACTCC","CAGAC","CAGTC","GCAGA","AAGGG","ACAGA","CTTCA","ACCAT","GCACA","TCTAA","ACAAC","CTGTC","CTTTC","AGCCT","ACTCT","GATGC","GCCAC","AGAGC","ACTGC","ATCGG","TCTCA","ACCCA","GATAC","ACCTG","CCATA","ATCCG","ATCAC","TGCCA","CTTGC","ATTCC","AGGGC","ATATC","GAATA","AAGAC","ATTAC","ATCGA","CTGCC","ATCGC","ACTGG","GTAGA","CCAAG","AATTC","GCCGA","CCACA","AATAG","CATGC"],["11.79","11.62","11.07","11.95","10.46","11.33","10.81","10.59","10.78","11.61","11.21","11.65","10.76","12.02","11.55","11.51","10.33","11.01","11.64","11.11","10.19","10.32","10.63","11.52","10.64","11.32","11.21","11.27","11.77","12.30","10.90","10.72","11.31","11.06","10.49","11.64","10.52","10.51","10.93","11.00","10.18","11.27","10.79","11.61","10.75","10.91","10.08","10.82","11.17","11.88","10.06","10.71","10.99","11.73","10.66","11.40","11.07","11.57","10.61","11.75","11.78","10.98","11.14","10.73","11.18","11.28","11.38","11.14","10.97","10.86","10.71","11.29","11.34","10.13","11.28","10.81","10.07","11.25","10.57"," 9.75","10.99","11.00","10.56","10.78","10.41","10.68","10.99","11.10","10.81","10.22","10.99"," 9.98","11.02","10.46","10.81","10.88","10.28","11.43","10.86","10.86"],[" -1.53"," -1.46","  1.20"," -1.46","  2.45"," -1.27","  1.79","  1.69"," -1.33"," -1.08"," -1.79"," -1.12","  2.31"," -2.29","  1.03"," -0.87","  2.36"," -0.96"," -1.24","  0.98","  2.74","  1.38"," -0.99"," -0.98","  1.80"," -1.06"," -1.60","  1.10"," -0.77"," -1.61"," -0.91"," -1.25","  0.77","  0.85","  1.46"," -0.77"," -1.00"," -1.17","  3.14"," -0.87"," -1.27"," -0.85"," -0.86"," -1.43"," -0.77"," -1.07"," -1.23"," -0.81","  1.32"," -1.25","  1.55"," -0.95","  1.54"," -1.01"," -1.06"," -0.97"," -0.78"," -0.89"," -0.75"," -0.88"," -0.60","  0.76"," -0.95","  1.54"," -0.78"," -0.90"," -0.79","  2.07"," -0.78"," -0.72"," -0.91"," -1.00","  1.38","  3.87"," -0.64"," -0.87","  1.13","  1.81","  0.71"," -1.81"," -0.75"," -0.68"," -0.80","  0.74"," -0.94","  1.23","  1.20"," -0.62","  1.55","  2.02"," -0.88","  1.94"," -0.63"," -0.84","  1.60","  1.50","  2.85"," -0.71","  1.45"," -0.84"],["3.41e-06","3.45e-06","8.25e-06","8.72e-06","1.17e-05","1.92e-05","2.15e-05","2.61e-05","2.76e-05","3.06e-05","3.12e-05","3.57e-05","3.59e-05","4.12e-05","4.16e-05","4.40e-05","4.66e-05","4.89e-05","5.01e-05","5.70e-05","5.88e-05","5.96e-05","6.02e-05","6.39e-05","6.81e-05","7.04e-05","7.45e-05","9.72e-05","9.88e-05","1.03e-04","1.04e-04","1.07e-04","1.11e-04","1.12e-04","1.12e-04","1.13e-04","1.21e-04","1.25e-04","1.27e-04","1.39e-04","1.42e-04","1.55e-04","1.57e-04","1.59e-04","2.00e-04","2.05e-04","2.14e-04","2.33e-04","2.61e-04","2.73e-04","3.06e-04","3.13e-04","3.21e-04","3.41e-04","3.45e-04","3.89e-04","4.03e-04","4.65e-04","4.65e-04","4.67e-04","4.73e-04","4.76e-04","5.22e-04","5.24e-04","5.64e-04","5.79e-04","6.07e-04","6.45e-04","6.51e-04","6.61e-04","7.00e-04","7.03e-04","7.39e-04","7.42e-04","7.73e-04","7.99e-04","8.15e-04","8.30e-04","8.54e-04","8.58e-04","8.92e-04","9.84e-04","9.84e-04","1.08e-03","1.09e-03","1.12e-03","1.20e-03","1.21e-03","1.30e-03","1.34e-03","1.34e-03","1.46e-03","1.50e-03","1.50e-03","1.63e-03","1.63e-03","1.66e-03","1.68e-03","1.72e-03","1.75e-03"],["8.82e-04","8.82e-04","1.12e-03","1.12e-03","1.20e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.34e-03","1.36e-03","1.39e-03","1.39e-03","1.41e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.60e-03","1.66e-03","1.66e-03","1.66e-03","1.78e-03","1.78e-03","1.85e-03","1.85e-03","1.85e-03","2.28e-03","2.28e-03","2.33e-03","2.49e-03","2.73e-03","2.80e-03","3.07e-03","3.08e-03","3.10e-03","3.21e-03","3.21e-03","3.55e-03","3.62e-03","3.93e-03","3.93e-03","3.93e-03","3.93e-03","3.93e-03","4.19e-03","4.19e-03","4.44e-03","4.49e-03","4.64e-03","4.83e-03","4.83e-03","4.83e-03","5.00e-03","5.00e-03","5.13e-03","5.13e-03","5.28e-03","5.38e-03","5.42e-03","5.45e-03","5.49e-03","5.49e-03","5.64e-03","6.07e-03","6.07e-03","6.57e-03","6.57e-03","6.68e-03","7.02e-03","7.02e-03","7.50e-03","7.55e-03","7.55e-03","8.12e-03","8.14e-03","8.14e-03","8.71e-03","8.71e-03","8.77e-03","8.77e-03","8.89e-03","8.95e-03"],["6.01e-03","6.01e-03","7.61e-03","7.61e-03","8.15e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.14e-03","9.30e-03","9.45e-03","9.45e-03","9.63e-03","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.09e-02","1.13e-02","1.13e-02","1.13e-02","1.21e-02","1.21e-02","1.26e-02","1.26e-02","1.26e-02","1.55e-02","1.55e-02","1.59e-02","1.70e-02","1.86e-02","1.91e-02","2.09e-02","2.10e-02","2.11e-02","2.19e-02","2.19e-02","2.42e-02","2.47e-02","2.68e-02","2.68e-02","2.68e-02","2.68e-02","2.68e-02","2.86e-02","2.86e-02","3.03e-02","3.06e-02","3.16e-02","3.29e-02","3.29e-02","3.29e-02","3.41e-02","3.41e-02","3.50e-02","3.50e-02","3.60e-02","3.67e-02","3.70e-02","3.71e-02","3.74e-02","3.74e-02","3.84e-02","4.14e-02","4.14e-02","4.48e-02","4.48e-02","4.55e-02","4.79e-02","4.79e-02","5.11e-02","5.15e-02","5.15e-02","5.53e-02","5.55e-02","5.55e-02","5.94e-02","5.94e-02","5.98e-02","5.98e-02","6.06e-02","6.10e-02"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,false,false,false,false,false,false,false,false,false,false,false,false]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>k5topTable <span class="sc">%&gt;%</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>            <span class="co"># dplyr::filter(-log10(P.Value) &gt; 4 | logFC &gt; 4 | logFC &lt; -2),</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">2.5</span>),</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 5"</span>) <span class="sc">+</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-6-1" class="level2">
<h2 class="anchored" data-anchor-id="k-6-1">k = 6</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k6topTable,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 6-mers."</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k6topTable, DE)),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k6topTable),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-6baf762a10131bb4bcc8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6baf762a10131bb4bcc8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 6-mers. 312 of 2080 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["GTATTA","AATAGA","GTCAAA","TATTCA","AGTAAT","ATACAG","GTAATA","GTCTAA","ACTACT","ACTGAT","TACTCA","TACTGA","GAGTAA","AATACA","ATTTGG","AATTCC","AACTTA","AATTCG","GAATTC","GTTCTA","ATCGCG","ACCATA","ACTTAG","CAAATG","AAGCTA","AGTGCA","CTTTGA","TGATCA","AGGTCG","ATATGG","GTGCAA","CGCGCC","ACTATG","GCATAA","CATTGC","CCTTAG","CTATAC","CTATTC","CACTAA","TAGACA","ATATCG","AACGTA","CATAGC","CCGATC","GTGAAC","ATCAAG","CAGTAG","ATAGAC","TATCGA","AAAGCC","CATATC","ATCGGC","AATCTC","AGATTC","ATAGTC","GATCAA","ATACCG","CGTGCC","ACTAAG","TCAAGA","GCGCGA","GGTCAA","GGATTA","CAAAGC","CAGGTC","ATACCA","ATCGAT","TGTGAA","GGATAA","ACTGCA","TATGCA","CCCAGG","TCGGCA","AGATCT","ATTGCA","AGGTCA","AGTTTC","GATCGC","AATTTC","GATTAC","CCACTA","AAGTAG","CGATCG","CAATGG","CCCCCG","CTTGGA","TATCCA","TCGAAA","ACACTG","AAACGT","TAAGGA","TACCGA","CTATGC","CGATAC","GCACTA","CACGGG","ACTACC","AATCCA","CCGTGC","ACCTGG"],[" 8.92"," 9.29"," 9.71"," 9.67"," 9.22"," 9.60"," 9.14"," 8.89"," 9.00"," 9.58"," 8.81"," 9.32"," 8.92"," 9.83"," 9.34"," 8.77"," 9.11"," 8.01"," 7.84"," 8.13"," 7.93"," 8.90"," 8.26"," 9.81"," 8.76"," 9.63"," 9.73"," 8.54"," 9.11"," 9.06"," 9.01"," 8.21"," 8.86"," 8.72"," 8.93"," 8.42"," 8.13"," 8.96"," 9.13"," 9.07"," 8.38"," 7.73"," 8.12"," 9.18"," 9.46"," 9.18"," 9.31"," 8.81"," 8.80"," 9.57"," 8.96"," 8.92"," 9.18"," 8.97"," 8.55"," 9.23"," 8.02"," 8.31"," 8.51"," 9.34"," 8.15"," 9.41"," 8.66"," 9.56"," 9.92"," 8.44"," 8.02","10.11"," 8.66","10.29"," 9.09"," 9.55"," 8.94"," 8.31"," 9.26"," 9.51"," 9.37"," 8.47"," 9.37"," 8.41"," 9.09"," 8.50"," 7.44"," 9.10"," 8.51"," 9.44"," 8.88"," 8.00"," 9.93"," 8.62"," 9.07"," 7.98"," 8.36"," 8.03"," 8.64"," 8.41"," 8.89"," 9.42"," 8.38"," 9.56"],[" 4.27"," 3.35"," 3.01"," 2.67"," 3.15"," 2.48"," 4.08"," 5.12"," 3.97"," 2.76"," 3.41"," 3.12"," 3.19"," 2.65"," 2.09"," 2.53"," 3.06"," 4.38"," 4.40"," 1.78"," 7.46"," 3.85"," 5.04"," 2.06"," 2.28"," 3.36"," 2.46"," 2.50"," 7.80"," 3.44"," 2.05"," 7.76"," 3.19"," 2.82"," 2.06"," 5.89"," 1.69"," 3.72"," 2.67"," 3.06"," 5.14"," 2.17","-1.50"," 7.79"," 3.85"," 1.71"," 4.24"," 3.74"," 6.98"," 2.68"," 3.34"," 6.67"," 1.59"," 1.97"," 3.72"," 2.14"," 5.93"," 5.97"," 3.93"," 1.53"," 6.69"," 4.01"," 1.80"," 2.48"," 6.04"," 1.24"," 5.95"," 1.52","-1.57"," 4.17"," 2.32"," 6.36"," 6.32","-1.57"," 2.09"," 3.82"," 0.99"," 5.73"," 2.67"," 1.65"," 4.51"," 1.32"," 7.44"," 2.28"," 6.46"," 4.71","-1.34"," 1.29"," 1.66"," 1.61"," 3.76"," 5.72"," 3.84"," 5.63"," 3.52"," 5.44"," 5.56"," 1.01"," 5.41"," 5.24"],["1.18e-07","1.51e-07","1.72e-07","2.45e-07","3.37e-07","3.84e-07","6.05e-07","1.19e-06","2.29e-06","2.40e-06","2.61e-06","3.05e-06","3.14e-06","3.47e-06","3.47e-06","3.62e-06","3.95e-06","4.28e-06","5.04e-06","5.36e-06","5.39e-06","6.30e-06","6.46e-06","6.55e-06","6.57e-06","7.30e-06","8.37e-06","8.87e-06","9.40e-06","1.04e-05","1.13e-05","1.15e-05","1.15e-05","1.16e-05","1.16e-05","1.18e-05","1.20e-05","1.22e-05","1.23e-05","1.23e-05","1.27e-05","1.29e-05","1.35e-05","1.37e-05","1.39e-05","1.47e-05","1.48e-05","1.56e-05","1.59e-05","1.78e-05","1.78e-05","1.84e-05","1.88e-05","1.89e-05","1.92e-05","2.01e-05","2.03e-05","2.30e-05","2.34e-05","2.39e-05","2.42e-05","2.45e-05","2.57e-05","2.59e-05","2.60e-05","2.64e-05","2.68e-05","2.70e-05","2.86e-05","2.88e-05","2.97e-05","3.00e-05","3.11e-05","3.16e-05","3.23e-05","3.30e-05","3.33e-05","3.38e-05","3.40e-05","3.54e-05","3.77e-05","3.81e-05","3.82e-05","3.89e-05","4.22e-05","4.27e-05","4.43e-05","4.43e-05","4.49e-05","4.69e-05","4.71e-05","4.72e-05","4.74e-05","4.79e-05","4.80e-05","5.35e-05","5.43e-05","5.47e-05","5.48e-05","5.54e-05"],["1.19e-04","1.19e-04","1.19e-04","1.28e-04","1.33e-04","1.33e-04","1.80e-04","3.09e-04","4.70e-04","4.70e-04","4.70e-04","4.70e-04","4.70e-04","4.70e-04","4.70e-04","4.70e-04","4.83e-04","4.95e-04","5.34e-04","5.34e-04","5.34e-04","5.47e-04","5.47e-04","5.47e-04","5.47e-04","5.84e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.40e-04","6.42e-04","6.42e-04","6.42e-04","6.54e-04","6.54e-04","6.74e-04","6.74e-04","7.25e-04","7.25e-04","7.27e-04","7.27e-04","7.27e-04","7.27e-04","7.42e-04","7.42e-04","8.21e-04","8.21e-04","8.21e-04","8.21e-04","8.21e-04","8.27e-04","8.27e-04","8.27e-04","8.27e-04","8.27e-04","8.27e-04","8.56e-04","8.56e-04","8.65e-04","8.65e-04","8.87e-04","8.87e-04","8.95e-04","8.95e-04","8.95e-04","8.95e-04","8.95e-04","9.20e-04","9.59e-04","9.59e-04","9.59e-04","9.64e-04","1.03e-03","1.03e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.05e-03","1.14e-03","1.14e-03","1.14e-03","1.14e-03","1.14e-03"],["9.77e-04","9.77e-04","9.77e-04","1.05e-03","1.09e-03","1.09e-03","1.48e-03","2.54e-03","3.86e-03","3.86e-03","3.86e-03","3.86e-03","3.86e-03","3.86e-03","3.86e-03","3.86e-03","3.97e-03","4.07e-03","4.39e-03","4.39e-03","4.39e-03","4.49e-03","4.49e-03","4.49e-03","4.49e-03","4.80e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.26e-03","5.27e-03","5.27e-03","5.27e-03","5.38e-03","5.38e-03","5.54e-03","5.54e-03","5.96e-03","5.96e-03","5.98e-03","5.98e-03","5.98e-03","5.98e-03","6.09e-03","6.09e-03","6.75e-03","6.75e-03","6.75e-03","6.75e-03","6.75e-03","6.80e-03","6.80e-03","6.80e-03","6.80e-03","6.80e-03","6.80e-03","7.03e-03","7.03e-03","7.11e-03","7.11e-03","7.29e-03","7.29e-03","7.35e-03","7.36e-03","7.36e-03","7.36e-03","7.36e-03","7.56e-03","7.88e-03","7.88e-03","7.88e-03","7.92e-03","8.48e-03","8.48e-03","8.61e-03","8.61e-03","8.62e-03","8.64e-03","8.64e-03","8.64e-03","8.64e-03","8.64e-03","8.64e-03","9.39e-03","9.39e-03","9.39e-03","9.39e-03","9.39e-03"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 6"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are some differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>k6topTable <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">2.3</span>),</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 6"</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-7-1" class="level2">
<h2 class="anchored" data-anchor-id="k-7-1">k = 7</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k7topTable,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 7-mers."</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k7topTable, DE)),</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k7topTable),</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-589a4f35414639d060d7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-589a4f35414639d060d7">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 7-mers. 658 of 8192 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["TAATACA","AGTAATA","GTAATAC","CGTATCA","ACGTATC","GGCGCGA","CGCGATC","CGGCACG","ATTACTC","ATCGCGC","CCGGGTA","AATAGAC","AATACAG","ACGGGGG","ACCAGGG","GATCTAC","CTATTCA","TAATCCA","AGATCTA","GTGCCGA","GCGATCC","GGGTCTA","CGGGGGC","CCGTGCC","CACGGGG","TGAGTAA","AGGTCGG","CCCGTGC","AACCGGC","CAGGTCG","AATCCAA","CGATCCC","ATCAGTA","CCTTAGA","CCGATCA","AGCCCCC","GGTCGGA","CGTCTAA","GGTTCAC","AGGTCAA","AATTTCT","CTAAGGA","AGGCGCG","GGTCAAA","ATCGGCA","CTGAGTA","ATTCTCC","ACATTTG","GAATAGA","ACTACTG","CTTAGAC","CAGGCGC","GATCGGC","AGTAGTG","TAGACGA","ACATAGC","ACCGGCC","CGATCAG","TCTAAGA","CCGGTTC","ACAGGCG","GATTACA","CGGCCCA","TATAGAA","ATTACAG","ACGACCT","GGGAGAA","ACCTGGG","TGATCAA","GCTTTGA","CATTTGG","CAAGCTA","GGTGAAC","AAGACTT","CCACTAC","CCAGGTC","CCGGCCC","CATTGCA","ATGATCA","GACTACC","ACGGAGC","CTAGACC","CTTTGAC","AACTTAG","ACCATAT","GGACTAC","TGCATAA","CCCACTA","AGGACAA","ATTTCTG","TGGATAA","ATCTAAG","TCGGAGA","ACTGATC","CCTTGGA","CTCCGAC","CGTCGGA","GACGACC","TAGTCCA","CGAATTC"],[" 8.10"," 8.07"," 7.61"," 5.36"," 5.25"," 7.51"," 7.51"," 7.58"," 7.67"," 7.51"," 4.86"," 7.93"," 8.36"," 7.62"," 7.08"," 6.66"," 7.95"," 7.48"," 6.86"," 7.68"," 7.59"," 5.30"," 7.68"," 7.70"," 7.71"," 7.90"," 7.63"," 7.66"," 7.67"," 8.72"," 7.89"," 7.62"," 8.09"," 7.77"," 7.74"," 7.88"," 7.65"," 7.83"," 8.23"," 8.53"," 8.11"," 7.83"," 7.66"," 8.32"," 8.42"," 7.67"," 7.29"," 8.46"," 7.91"," 7.98"," 7.88"," 7.91"," 8.42"," 7.90"," 7.86"," 6.27"," 7.71"," 7.83"," 6.26"," 7.68"," 7.94"," 7.30"," 7.76"," 7.28"," 7.75"," 7.91"," 7.57"," 7.90"," 7.81"," 8.34"," 7.81"," 7.07"," 8.46"," 7.61"," 8.19"," 8.86"," 7.80"," 7.79"," 7.89"," 7.91"," 7.91"," 5.62"," 8.33"," 7.54"," 7.87"," 7.97"," 7.67"," 8.21"," 7.56"," 8.46"," 7.55"," 6.06"," 7.92"," 8.21"," 8.07"," 7.85"," 5.35"," 8.01"," 8.59"," 6.81"],[" 6.74"," 6.78"," 8.53"," 2.66"," 2.77","11.28","10.89","10.84"," 8.10","10.89"," 3.90"," 7.95"," 5.26","10.42","-2.84","-3.79"," 7.67"," 4.49","-3.22"," 9.85"," 9.97","-1.96"," 9.86"," 9.78"," 9.71"," 6.58","10.22"," 9.98"," 9.57","10.54"," 3.78"," 9.77"," 7.23"," 9.64"," 9.29"," 8.73"," 9.95","10.38"," 9.39"," 8.18"," 4.00"," 9.47","10.60"," 6.60","10.12"," 7.75","-2.01"," 4.60"," 7.59"," 7.60"," 9.72"," 9.45","10.15"," 7.97"," 9.94","-3.47"," 9.21"," 8.66","-3.15"," 9.10"," 9.14"," 3.36"," 9.07"," 3.79"," 2.65"," 9.71","-2.26"," 8.35"," 4.36"," 6.32"," 4.87"," 6.64"," 7.97"," 2.24"," 8.93"," 9.13"," 8.69"," 4.77"," 4.07"," 9.22"," 8.42","-1.95"," 6.32"," 8.63"," 7.91"," 9.11"," 5.21"," 8.62","-1.67"," 3.23","-2.33","-3.29"," 8.38"," 6.68"," 8.53"," 8.46","-6.35"," 9.21"," 9.40"," 8.84"],["8.37e-08","1.80e-07","2.35e-07","2.67e-07","2.77e-07","3.36e-07","3.78e-07","3.86e-07","4.03e-07","4.48e-07","4.62e-07","4.96e-07","5.47e-07","6.33e-07","6.88e-07","7.39e-07","7.54e-07","7.77e-07","7.78e-07","7.93e-07","8.84e-07","9.06e-07","9.14e-07","9.17e-07","9.34e-07","9.54e-07","9.56e-07","9.56e-07","9.97e-07","1.03e-06","1.08e-06","1.09e-06","1.14e-06","1.16e-06","1.24e-06","1.24e-06","1.28e-06","1.30e-06","1.31e-06","1.37e-06","1.39e-06","1.40e-06","1.40e-06","1.41e-06","1.47e-06","1.54e-06","1.56e-06","1.58e-06","1.59e-06","1.84e-06","1.85e-06","1.89e-06","1.93e-06","1.98e-06","1.98e-06","2.01e-06","2.10e-06","2.13e-06","2.20e-06","2.23e-06","2.23e-06","2.24e-06","2.37e-06","2.39e-06","2.41e-06","2.44e-06","2.50e-06","2.55e-06","2.73e-06","2.83e-06","2.88e-06","2.91e-06","2.92e-06","2.99e-06","3.04e-06","3.14e-06","3.63e-06","3.64e-06","3.65e-06","3.69e-06","3.84e-06","3.87e-06","3.88e-06","3.88e-06","4.11e-06","4.14e-06","4.38e-06","4.48e-06","4.52e-06","4.55e-06","4.57e-06","4.68e-06","4.85e-06","4.95e-06","5.04e-06","5.05e-06","5.07e-06","5.10e-06","5.15e-06","5.32e-06"],["2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.62e-04","2.65e-04","2.65e-04","2.65e-04","2.65e-04","2.65e-04","2.94e-04","2.94e-04","2.94e-04","2.94e-04","2.94e-04","2.94e-04","2.94e-04","2.96e-04","2.96e-04","2.96e-04","2.96e-04","2.96e-04","2.96e-04","3.02e-04","3.02e-04","3.02e-04","3.02e-04","3.05e-04","3.07e-04","3.24e-04","3.28e-04","3.28e-04","3.28e-04","3.28e-04","3.31e-04","3.32e-04","3.38e-04","3.78e-04","3.78e-04","3.78e-04","3.78e-04","3.79e-04","3.79e-04","3.79e-04","3.79e-04","3.94e-04","3.94e-04","4.11e-04","4.11e-04","4.11e-04","4.11e-04","4.11e-04","4.16e-04","4.26e-04","4.26e-04","4.26e-04","4.26e-04","4.26e-04","4.26e-04","4.26e-04","4.36e-04"],["2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.51e-03","2.54e-03","2.54e-03","2.54e-03","2.54e-03","2.54e-03","2.81e-03","2.81e-03","2.81e-03","2.81e-03","2.81e-03","2.81e-03","2.81e-03","2.84e-03","2.84e-03","2.84e-03","2.84e-03","2.84e-03","2.84e-03","2.90e-03","2.90e-03","2.90e-03","2.90e-03","2.93e-03","2.94e-03","3.11e-03","3.14e-03","3.14e-03","3.14e-03","3.14e-03","3.17e-03","3.19e-03","3.25e-03","3.63e-03","3.63e-03","3.63e-03","3.63e-03","3.63e-03","3.63e-03","3.63e-03","3.63e-03","3.78e-03","3.78e-03","3.94e-03","3.94e-03","3.94e-03","3.94e-03","3.94e-03","3.99e-03","4.09e-03","4.09e-03","4.09e-03","4.09e-03","4.09e-03","4.09e-03","4.09e-03","4.18e-03"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 7"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>k7topTable <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">6.4</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">5</span>),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 7"</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-8-1" class="level2">
<h2 class="anchored" data-anchor-id="k-8-1">k = 8</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k8topTable,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 8-mers."</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k8topTable, DE)),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k8topTable),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-2e736caf2a770def88da" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e736caf2a770def88da">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 8-mers. 1742 of 32896 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CGGGTACC","ACCAGGGA","CCCTGGTC","CCTGATTC","ATTCTCCC","AAGATCTA","CCAGGGAG","ATCCGACG","GATTCTCC","AGGGAGAA","CTACTAAG","ACGTCGGA","CGTGCCGA","GATCTACA","GAGTAATA","CCGTGCCG","ATCGCGCC","ACGGGGGC","GATCGCGC","GCGATCCC","CTGTATTA","CGCGATCC","AGGCGCGA","ATCGGCAC","GTAATACA","AGTAATAC","CACGGGGG","ACTGATCG","CAGGCGCG","CCCCGTGC","ATTACTCA","CCCGTGCC","ATCTACAG","AGATCTAC","AGGTCGGA","CGATCCCA","AGCCCCCG","CAGGACAA","GAATAGAC","CAGGGACC","CCTGAGTA","CCGATCAG","AACCGGCC","CTCTTAGA","CCATCCGA","CTATTCAC","AAGCCCCC","ATCAGGAC","CATCTAAG","TAGTGGGA","GCGGTCCC","CAGGTCGG","CTGAGTAA","CATTACGA","GCCGATCA","GAGAATCA","CATAGCTC","GATCAGTA","AGTGTCTA","CCGGCCCA","ACGTATCA","GCTGTAGA","AGGACAAG","ACGGAGCA","ACCGGCCC","CGGTTCAC","GAACCGGC","CTCCGACC","AGAGCTAT","TCAGGACA","CTAAGAGC","CGGCCCAG","ATCAGTAG","CCCAGGTC","ACTACTGA","ATACAGCG","GATCCCAC","CCGACGTC","CCGGTTCA","GCTTTGAC","AGTGGGAT","GTCTCCGA","ACCTACGC","AGTAGTGG","ACTCAGGC","CTAAGATC","ACAGGCGC","AAAGCCCC","AATCAGGA","GTAACAAC","ACCTGGGC","TCTATTCA","ATCTAAGA","AGAATCAG","CACAGGCG","AGGTCAAA","GTCGGAGA","AATAGACA","CGTATCAA","ATAGACAC"],["3.45","5.34","5.44","5.48","5.56","5.78","5.45","4.58","5.74","6.32","3.23","4.59","7.42","5.87","7.25","7.44","7.34","7.44","7.37","7.38","7.32","7.37","7.35","7.47","7.26","7.26","7.46","7.47","7.35","7.47","7.25","7.47","6.16","5.91","7.45","7.44","7.47","6.10","7.40","4.93","7.18","7.49","7.40","5.02","4.91","7.42","7.57","5.80","5.04","7.50","3.59","7.48","7.25","3.61","7.50","5.83","4.92","7.51","7.39","7.49","4.11","6.11","5.96","7.56","7.49","7.43","7.44","7.50","5.08","6.09","4.95","7.51","7.52","7.54","7.55","7.18","7.49","4.66","7.43","7.65","7.47","7.53","3.91","7.48","7.25","3.87","7.67","7.67","5.95","5.17","7.55","7.51","5.11","5.98","7.45","7.76","7.55","7.55","3.27","7.45"],["  7.60"," -6.25"," -6.19"," -4.99"," -4.72"," -6.67"," -5.80","-10.98"," -4.35"," -3.71","  3.17","-10.69"," 12.91"," -6.41"," 11.40"," 12.74"," 12.80"," 12.73"," 12.72"," 12.63"," 10.65"," 12.69"," 12.66"," 12.37"," 11.03"," 11.06"," 12.61"," 12.23"," 12.54"," 12.53"," 11.10"," 12.51"," -5.33"," -6.22"," 12.51"," 12.04"," 12.16"," -3.28"," 11.78"," -6.92"," 11.73"," 11.90"," 12.28"," -7.55"," -8.64"," 11.53"," 11.49"," -4.02"," -7.40"," 11.20","  5.25"," 12.19"," 10.89","  2.49"," 11.75"," -3.85"," -8.27"," 11.18"," 11.29"," 11.92","  6.68"," -5.75"," -3.83"," 11.61"," 11.74"," 11.72"," 11.67"," 11.89"," -7.11"," -3.56"," -8.05"," 11.74"," 11.10"," 11.57"," 10.86"," 11.16"," 11.43"," -9.97"," 11.60"," 10.67"," 11.08"," 11.68"," -9.42"," 11.26"," 10.98","  3.76"," 12.15"," 10.62"," -3.49"," -6.98"," 11.37"," 10.59"," -6.85"," -3.36"," 11.21","  9.99"," 11.41"," 10.16","  2.52"," 10.73"],["1.57e-08","1.87e-08","2.03e-08","3.53e-08","4.47e-08","8.35e-08","8.53e-08","1.09e-07","1.22e-07","1.44e-07","1.58e-07","1.58e-07","1.93e-07","2.03e-07","2.04e-07","2.15e-07","2.20e-07","2.22e-07","2.22e-07","2.23e-07","2.24e-07","2.25e-07","2.28e-07","2.38e-07","2.39e-07","2.41e-07","2.42e-07","2.50e-07","2.60e-07","2.71e-07","2.73e-07","2.73e-07","2.75e-07","2.79e-07","2.82e-07","2.86e-07","2.88e-07","2.92e-07","2.95e-07","2.99e-07","3.05e-07","3.07e-07","3.08e-07","3.11e-07","3.16e-07","3.16e-07","3.19e-07","3.19e-07","3.24e-07","3.32e-07","3.35e-07","3.43e-07","3.51e-07","3.54e-07","3.60e-07","3.71e-07","3.74e-07","3.76e-07","3.84e-07","3.84e-07","3.85e-07","3.98e-07","4.01e-07","4.08e-07","4.10e-07","4.23e-07","4.32e-07","4.34e-07","4.34e-07","4.35e-07","4.36e-07","4.42e-07","4.43e-07","4.54e-07","4.57e-07","4.59e-07","4.66e-07","4.66e-07","4.70e-07","4.72e-07","4.74e-07","4.74e-07","4.91e-07","5.04e-07","5.17e-07","5.22e-07","5.28e-07","5.31e-07","5.32e-07","5.38e-07","5.42e-07","5.42e-07","5.51e-07","5.52e-07","5.75e-07","5.93e-07","6.05e-07","6.10e-07","6.35e-07","6.37e-07"],["1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.90e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.93e-04","1.99e-04","2.03e-04","2.05e-04","2.05e-04","2.09e-04","2.09e-04"],["2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.09e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.12e-03","2.19e-03","2.23e-03","2.25e-03","2.25e-03","2.30e-03","2.30e-03"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>k8topTable <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">7.2</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="fl">12.5</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">8</span>),</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 8"</span>) <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-9-1" class="level2">
<h2 class="anchored" data-anchor-id="k-9-1">k = 9</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k9topTable,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 9-mers."</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k9topTable, DE)),</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k9topTable),</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ad2ec71c0808cbf3e44b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ad2ec71c0808cbf3e44b">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 9-mers. 5761 of 131072 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CGACGGGTA","ATGCGTGGA","CGCATCGAC","GCATCGACC","GCGGGTACC","CTTAGTAGC","CCCGACGGG","GCAGGGACC","ACATAGCTC","CACGCATCG","CCGAAGATA","ACGGGTACC","ACGTCGGAT","GACGTCGGA","CATCCGACG","AAGACGCGT","CGGATGGAA","TCCATCCGA","CCATCCGAC","ATGACGTCG","ATCTAAGAG","GCTCTTAGA","ACCGCCCGT","TCATTACGA","CCGACGTCA","CTATTACCA","ATCGTAATG","CCCTGGTCC","CGGCCCCGA","AAATCGTAA","GCCCCGAGA","TACTAAGAA","CGGGTACCC","AAAGATCTA","CAACATAGC","CAGGGACCA","CTATCGAAG","ACGGAGCAA","AACATAGCT","AAGAGCTAT","CTGTAGATC","TCGTCCGAA","CGTCGGGGA","CTTAGATGA","AGCTCTTAG","ACGCGTTAT","AGAGCTATG","CGGAGCAAG","ACGCATCGA","GTGGTAATA","GTCATCTAA","AGCAGGGGC","ATCTACAGC","CGTCATCTA","GACCAGGGA","AGATCTACA","ACCAGGGAG","CATCTAAGA","AAGGCTGCC","CCCGGACGG","ACGGTTCGA","CGGGCGGTC","GACGTAGGC","CAACCTACG","ACAACATAG","AGTAACAAC","CCCCGACGC","GAATCAGGA","CCAGGGAGA","AAGATCTAC","ATCCAGTAA","CCTGGTCCC","AGGGACCAG","AAATTGCTC","AAAGACCTT","AATTGCTCT","CCGACGCGC","GATTCTCCC","AACAACCTA","CCCCTGCGA","CGATTTTTC","ACCTACGCT","AGCAAGCCC","GCAATTTCC","AACCTACGC","CTTCCATCC","ACGGGCGCC","CCCTGCGAA","GGGTTCAAA","ACCCGTCGG","GTAACAACA","ACCCCTGCG","TCTACAGCA","CACGGGTCG","CTAAGCGCA","CGCGCCCCG","CGACCGTTA","GGTTCGGAC","GCAGGGGCC","CGGTCGTTA"],[" 0.69"," 2.63"," 2.45"," 2.67"," 1.32"," 1.79"," 1.19"," 4.34"," 4.38"," 2.45"," 0.64"," 1.09"," 4.34"," 4.37"," 4.37"," 0.80"," 4.55"," 4.48"," 4.48"," 4.44"," 4.48"," 4.50"," 0.86"," 2.23"," 4.43"," 2.36"," 2.10"," 4.84"," 1.57"," 2.45"," 1.63"," 2.35"," 2.01"," 5.30"," 4.51"," 4.39"," 0.21"," 2.89"," 4.63"," 4.51"," 5.37"," 1.03"," 2.69"," 4.52"," 4.49"," 0.17"," 4.51"," 2.83"," 2.86"," 2.64"," 4.61"," 4.11"," 5.43"," 4.53"," 4.75"," 5.40"," 4.77"," 4.58"," 2.84"," 1.21"," 0.97"," 1.15"," 2.84"," 3.57"," 4.65"," 4.63"," 2.80"," 4.86"," 4.81"," 5.37"," 4.65"," 4.40"," 4.45"," 2.99"," 3.36"," 3.01"," 2.80"," 4.80"," 3.97"," 2.36"," 2.66"," 3.55"," 2.90"," 2.66"," 3.64"," 4.85"," 1.12"," 2.56"," 2.93"," 1.14"," 4.78"," 2.58"," 5.54"," 2.41"," 2.60"," 2.29"," 0.00"," 2.59"," 3.85","-0.21"],[" 12.12","  6.36","  7.35","  6.00","  9.30","  7.46","  7.92","-10.68","-12.68","  6.86","  3.49","  8.25","-13.50","-13.12","-13.17","  3.31","-11.28","-11.94","-12.20","-12.33","-11.73","-11.64","  8.74","  5.71","-12.35","  4.19","  5.69"," -9.40","  7.99","  5.48","  7.45","  6.04"," 12.77","-10.10","-11.64"," -9.19","  3.64","  5.55","-10.41","-11.32"," -9.79","  3.31"," 11.48","-11.23","-11.51","  4.89","-11.33","  5.42","  4.76","  3.43","-10.44"," -5.95"," -9.24","-11.36"," -9.56"," -9.30"," -9.24","-10.74","  3.33","  6.67","  2.98","  7.12"," 11.34","-12.12","-10.16","-10.58"," 11.77"," -7.89"," -8.12"," -9.27"," -9.89"," -8.86"," -8.63","  2.80","  2.81","  3.21"," 13.00"," -8.08"," -8.92","  8.76","  3.78","-12.17","  4.97","  3.63","-11.34"," -9.42","  7.39","  8.95","  3.70","  7.32"," -9.60","  7.18"," -8.43"," 14.48"," 12.29"," 13.98","  3.65"," 12.81"," -5.70"," -4.42"],["1.11e-10","1.68e-09","3.68e-09","3.93e-09","4.86e-09","7.58e-09","1.32e-08","1.95e-08","1.96e-08","1.96e-08","2.17e-08","2.33e-08","2.36e-08","2.72e-08","2.78e-08","3.06e-08","3.08e-08","3.21e-08","3.38e-08","3.75e-08","3.85e-08","4.02e-08","4.06e-08","4.10e-08","4.31e-08","4.41e-08","4.45e-08","4.55e-08","4.82e-08","5.03e-08","5.16e-08","5.17e-08","5.20e-08","5.36e-08","5.49e-08","5.68e-08","5.74e-08","5.87e-08","6.25e-08","6.42e-08","6.62e-08","6.68e-08","6.83e-08","6.96e-08","7.04e-08","7.19e-08","7.33e-08","7.55e-08","7.74e-08","7.77e-08","7.79e-08","8.66e-08","9.52e-08","9.62e-08","9.89e-08","9.95e-08","1.03e-07","1.03e-07","1.05e-07","1.08e-07","1.11e-07","1.12e-07","1.14e-07","1.18e-07","1.18e-07","1.18e-07","1.19e-07","1.20e-07","1.28e-07","1.29e-07","1.31e-07","1.33e-07","1.41e-07","1.42e-07","1.48e-07","1.48e-07","1.51e-07","1.51e-07","1.53e-07","1.53e-07","1.54e-07","1.54e-07","1.58e-07","1.66e-07","1.68e-07","1.70e-07","1.73e-07","1.78e-07","1.82e-07","1.83e-07","1.87e-07","1.89e-07","1.91e-07","1.92e-07","1.92e-07","1.94e-07","1.98e-07","1.98e-07","1.99e-07","2.00e-07"],["1.45e-05","1.10e-04","1.27e-04","1.27e-04","1.27e-04","1.65e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.00e-04","2.18e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.32e-04","2.41e-04","2.41e-04","2.41e-04","2.42e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.47e-04","2.50e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04","2.59e-04"],["1.80e-04","1.36e-03","1.57e-03","1.57e-03","1.57e-03","2.05e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.48e-03","2.70e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.87e-03","2.98e-03","2.98e-03","2.98e-03","3.00e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.05e-03","3.09e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03","3.20e-03"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 9"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>k9topTable <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(DE <span class="sc">&amp;</span> <span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">7.5</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">15</span>),</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 9"</span>) <span class="sc">+</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-10-1" class="level2">
<h2 class="anchored" data-anchor-id="k-10-1">k = 10</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k10topTable,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 10-mers."</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k10topTable, DE)),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k10topTable),</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b427a9b7ac64504bb0c2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b427a9b7ac64504bb0c2">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 10-mers. 26997 of 524800 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CCCCGACGGG","CGTTCCACGA","ACCCGTCGGG","CGTCGGGGAG","CGACGGGTAC","CCGTCTCGAC","GACGGGTACC","GATAGCAAGC","CCGTCGGGGA","CAGGCGGGTA","GCGGTCGGCA","ACGACGTTGG","ACTCCACGCA","CGTGGGTTCA","GGTCGGCGAC","AACTAAGACG","CTTTGAACCC","ACTACGTCCT","CGCCGACGCG","ACTTAATAAC","CACTCCCATG","AAGCTTGCTA","CGGGAAGGTC","CTTAGGATCC","TACTAAGAAA","GGCCCCGAGA","GGTAATAGGA","AGCAAGCCCC","ACTTCGATAG","CCCGTCGAGA","ACGGTCGGGC","ACCCGCCTGG","ATCGTAATGA","AATTTCCAAG","CGGCCCCGAG","CCCCGTCGAG","ATGCGTGGAG","AGGTTTTCGC","AGTGGTAATA","AATTGCTCTC","GGGAGTGGTA","CGTAATGAAA","AAGGTCTTTG","AAATCGTAAT","CACGGCCCCG","CCACGGCCCC","CGGGCGCCTC","AATCGTAATG","ACAGGACGTA","AATCGGTTCT","AGTGGACGGA","ATAACGCGTC","CTTAATAACC","CAACGTCGTG","AGGCGGGTAC","CGGGGGGGAG","ACGGGTACCC","AAAATCGTAA","ACCTGGCGCG","CGGAGCAAGC","AATAACGCGT","CTACCGTTAA","CACTCCACGC","GACGGGCGCC","CCGACCGCCC","TAAGCTGCCA","CACCGTTCCA","ACTAAGTACG","GGACGGAGCA","TTAGTAGCAA","ACGACGCTTA","AACCCACGGC","CCGACCGTTA","AACGGTCGGG","TAATAGGAGA","GCTACTAAGA","ACCCACGGCC","GGAGTGGTAA","CCACTCCACG","CCGTCCACTC","CGACCGTTAA","GCAATTTCCA","TAACCCAATA","CCGAGAGGCC","CGTAAAGTAC","CGCCCGTCCG","ATGGTAGGCG","CGGAATATAG","GATGCGTGGA","CCGTAAAGTA","CGTCCGGGGC","AACACGCCGC","ATACTAGTTG","TATCTTCGGA","CGGCAGAGCC","ATACAGGACG","GGAGCAAGCC","ACGTGCGATC","CCGGACGGGC","CGCCTCCCCG"],[" 0.45","-1.40"," 0.54"," 0.48"," 0.53"," 0.67"," 0.74"," 0.20"," 0.72"," 1.16"," 0.59","-1.06"," 2.24"," 1.21"," 0.29","-0.97"," 1.41","-1.06","-0.33"," 1.50"," 1.61"," 0.19"," 0.84","-1.28"," 1.65"," 1.05"," 1.04"," 2.15","-1.10"," 0.58","-1.80"," 1.21"," 1.34"," 1.69"," 1.12"," 0.58"," 2.12","-0.23"," 1.41"," 1.65"," 1.09"," 1.51"," 1.86"," 1.44"," 1.23"," 1.56"," 0.51"," 1.24","-0.48","-0.68"," 2.36","-1.13"," 1.12","-0.99"," 0.97"," 0.14"," 0.58"," 1.70"," 0.30"," 2.13","-1.01","-0.86"," 2.29"," 0.43"," 0.59"," 0.78"," 0.89","-2.12"," 2.20"," 1.46","-1.80"," 1.39","-1.83","-1.48"," 1.41"," 1.15"," 1.18"," 1.24"," 2.27"," 2.24","-1.15"," 1.81"," 0.93"," 1.28","-0.46"," 0.47"," 0.90","-1.37"," 2.02","-0.37"," 0.52"," 0.66"," 0.16","-0.80"," 0.89"," 0.31"," 2.24","-1.89"," 0.92"," 0.54"],[" 11.66","  9.59"," 12.65"," 10.70"," 14.63","  9.64"," 10.74","  7.14","  9.81"," 10.56"," 10.35","  7.42","  8.71"," 10.13"," 10.66"," -5.68","  9.54","  7.94","  5.92","  7.14","  7.46","  5.88","  9.49","  7.21","  8.28"," 11.85"," 10.39","  9.63","  8.17","  9.41","  9.31"," 10.22","  9.71","  8.03"," 11.67"," 10.77","  9.96","  5.51","  7.96","  7.63","  9.79","  8.96","  5.90","  9.39"," 10.29"," 10.04"," 11.45"," 10.20","  5.56","  5.54","  8.74","  8.97","  8.09","  6.75"," 12.63","  6.47"," 14.67","  7.75"," 10.08"," 10.28","  8.69","  8.66","  7.65"," 12.58"," 10.49","  5.32","  6.94","  7.16"," 10.52","  9.64","  8.70","  7.72","  7.58","  9.23","  8.01"," 10.48"," 10.19","  8.92","  9.18","  9.56","  5.58","  6.67","  7.16","  9.28","  5.77"," 11.39"," 13.04","  5.88"," 10.77","  4.71"," 10.91","  6.05","  5.67","  6.47","  8.15","  6.05","  8.40","  6.47","  9.43"," 11.16"],["1.50e-10","2.53e-10","2.72e-10","4.63e-10","7.26e-10","8.81e-10","9.85e-10","1.02e-09","1.52e-09","1.56e-09","2.21e-09","2.31e-09","2.40e-09","2.67e-09","3.04e-09","3.07e-09","3.34e-09","3.38e-09","3.43e-09","3.43e-09","3.56e-09","3.88e-09","3.99e-09","4.11e-09","4.11e-09","4.39e-09","4.47e-09","4.60e-09","4.63e-09","4.66e-09","4.69e-09","4.72e-09","4.79e-09","4.84e-09","5.03e-09","5.24e-09","5.27e-09","5.29e-09","5.78e-09","5.85e-09","5.92e-09","5.99e-09","6.51e-09","6.54e-09","6.54e-09","6.57e-09","6.91e-09","6.98e-09","7.16e-09","7.19e-09","7.44e-09","7.52e-09","7.95e-09","7.99e-09","8.06e-09","8.13e-09","8.20e-09","8.26e-09","8.39e-09","8.73e-09","8.75e-09","8.78e-09","8.78e-09","9.05e-09","9.13e-09","9.32e-09","9.39e-09","9.42e-09","9.54e-09","9.90e-09","9.93e-09","9.99e-09","1.00e-08","1.01e-08","1.01e-08","1.02e-08","1.02e-08","1.03e-08","1.04e-08","1.05e-08","1.06e-08","1.09e-08","1.09e-08","1.12e-08","1.13e-08","1.14e-08","1.15e-08","1.17e-08","1.19e-08","1.21e-08","1.23e-08","1.26e-08","1.26e-08","1.28e-08","1.31e-08","1.31e-08","1.32e-08","1.34e-08","1.35e-08","1.38e-08"],["4.75e-05","4.75e-05","4.75e-05","6.07e-05","6.67e-05","6.67e-05","6.67e-05","6.67e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.84e-05","6.91e-05","6.91e-05","6.91e-05","6.91e-05","6.91e-05","6.91e-05","7.00e-05","7.04e-05","7.06e-05","7.12e-05","7.12e-05","7.12e-05","7.13e-05","7.13e-05","7.13e-05","7.13e-05","7.17e-05","7.17e-05","7.23e-05"],["6.53e-04","6.53e-04","6.53e-04","8.35e-04","9.17e-04","9.17e-04","9.17e-04","9.17e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.40e-04","9.51e-04","9.51e-04","9.51e-04","9.51e-04","9.51e-04","9.51e-04","9.62e-04","9.69e-04","9.71e-04","9.78e-04","9.79e-04","9.79e-04","9.81e-04","9.81e-04","9.81e-04","9.81e-04","9.85e-04","9.85e-04","9.94e-04"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>k10topTable <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 10"</span>) <span class="sc">+</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-11-1" class="level2">
<h2 class="anchored" data-anchor-id="k-11-1">k = 11</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k11topTable,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 11-mers."</span>,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k11topTable, DE)),</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k11topTable),</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-80903ea8a0c1ed8761b0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-80903ea8a0c1ed8761b0">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 11-mers. 126157 of 2097152 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CGTCGTGGAAC","GCCGGGGACAA","CAAGCTTGCTA","AACGTCGTGGA","CGTTGGATAGC","CCGTTCCACGA","GACGTAGTCCA","CTTGCTATCCA","GCTTGCTATCC","AGCTTGCTATC","CACGACGTTGG","CGTTCCACGAC","CCCCGCTACCA","ACGTCGTGGAA","ACGACGTTGGA","TTGCTATCCAA","ACAAGCTTGCT","CCTCCCCAGTA","GCGAGCTCCCC","GGCCGGGGACA","CGTCCTGTATA","GTATATTCCTA","ATATACAGGAC","AGCGAGCTCCC","CCCGACCGTTA","GTCGTACTGAA","GACAAGCTTGC","CCCGTCGGGGA","AACGGTCGGGC","ATCCCCGCCGC","ATTACTGGGGA","GTAGGAATATA","CTGGGGAGGTA","AAAAGACGCGT","GTTGGATAGCA","GGGAGGTAAAC","CTACTCCGAGA","ATACGTCCCCG","TACAGGACGTA","CGGTCGGGCAC","CCGTAAAGTAC","GAGTAGACCGA","ACGAATCAAGT","AGCTCCCCGAC","AAGCTTGCTAT","GGACGCAGTCC","CCGTTCAACGA","ACGGTCGGGCA","TCAGTACGACA","CCGACCGCGCC","CGGAGTAGGGC","CCGCCGGGTAC","GGTGTGGACTA","TAGAAGACGCA","CCGACCGTTAA","ACGGGGACGTA","CTTGCTAAGCA","CTGTCGGCGTC","CTGTCGCCGAC","ATCGCACGTGA","CGCCGACCGCG","ACGTTCTGTGC","ACGACAGGACC","ATCACGTGCGA","ATCGGTCCGCC","ATATGGAAATC","AACGGAATATA","ACCTGGCGCGG","ACCCGTCGGGG","CCGTCGGGGAG","CCAGTAATGGC","AATAACGCGTC","CCGAGATTAAC","CGTCGGGGAGC","GAGCTCCCCGA","CGGTCGGCGAC","CCGTGTCTATA","AATCGGTCCGC","ATATTCCGTTC","GAGGCCGGGGA","ACGTGCGATCT","GCTGTCGCCGA","ATTAACGGTCG","GAACCTGGCGC","GAGAGTATAAC","GAGTTAGGAGC","AGACCTTCCCG","ATCGAGTTAGG","AACGGTAGGAT","GGTCGGCGACA","ACGCGTTATTC","CCCGGGCACCG","CGGGCCATACG","TAATGGCCCAA","GAACCCACGGC","CTCGCCAGGAA","ATTGGCGCGGG","CGGCTGAAACC","CCGACAATGTA","AAGGTCTTTGA"],[" -2.01"," -1.04"," -0.85"," -2.01"," -1.10"," -2.03"," -1.77"," -0.91"," -0.53"," -0.82"," -1.53"," -1.79"," -2.96"," -1.85"," -1.97"," -0.83"," -0.53"," -1.32","  0.19"," -1.11"," -0.76"," -0.83"," -0.59","  0.21"," -2.27"," -0.79"," -0.70","  0.19"," -2.28"," -1.22"," -1.32"," -1.09"," -1.28"," -1.29"," -0.86"," -1.30"," -1.68"," -1.85"," -1.37"," -1.96"," -1.31"," -2.00"," -2.33","  0.27"," -0.69"," -1.99"," -2.38"," -2.17"," -0.79","  0.12"," -2.24"," -2.83"," -1.32"," -1.68"," -2.20"," -1.89"," -0.62"," -0.98","  0.11"," -2.28","  0.10"," -1.29"," -1.41"," -2.10"," -2.99"," -0.11"," -1.93","  0.12","  0.22","  0.23"," -0.82"," -1.81"," -1.44","  0.17","  0.37","  0.10"," -1.94"," -2.96"," -1.77"," -0.59"," -2.54","  0.20"," -2.06","  0.18"," -1.85"," -2.47","  0.53"," -2.58"," -1.62","  0.10"," -1.75"," -1.30"," -2.31"," -1.07","  0.92"," -2.02"," -2.38"," -1.90"," -2.94","  0.93"],[" 15.38"," 13.47"," 11.84"," 15.63"," 15.04"," 16.09"," 12.54"," 12.32"," 11.73"," 11.50"," 10.64"," 12.11"," 13.53"," 12.95"," 16.36"," 12.09","  9.73"," 11.26"," 12.90"," 14.86"," 11.81"," 10.55","  9.83"," 12.16"," 11.91"," 10.23"," 11.02"," 14.24"," 12.10"," 13.96"," 11.56"," 12.64","  9.89"," 11.23"," 11.39"," 10.98","  9.05"," 10.71","  9.23","  8.99","  9.56","  9.26"," 11.20"," 12.59","  9.77"," 13.64"," 10.62"," 11.42","  9.38"," 12.21"," 12.44","  9.56","  9.11","  9.70"," 10.72"," 10.54","  7.97","  7.34"," 11.99","  9.35"," 12.34","  8.91"," 12.93","  8.97"," 10.36","  9.65","  9.99"," 12.04"," 14.83"," 14.47","  8.05"," 16.07","  7.84"," 15.07"," 10.85"," 12.10","  9.47"," 10.32","  8.83","  9.38"," 10.35"," 11.36"," 10.60"," 11.15","  9.69","  8.44"," 12.16"," 10.76"," 16.60"," 11.70"," 14.57"," 10.69","  9.19","  8.94"," 11.62","  8.10","  9.00","  8.44"," 11.84"," 11.42"],["6.29e-12","7.35e-12","1.39e-11","1.60e-11","1.64e-11","2.18e-11","2.99e-11","3.13e-11","3.33e-11","3.97e-11","4.08e-11","4.15e-11","4.92e-11","5.61e-11","5.69e-11","6.41e-11","7.45e-11","8.29e-11","9.12e-11","1.02e-10","1.03e-10","1.15e-10","1.34e-10","1.47e-10","1.61e-10","1.67e-10","1.70e-10","1.79e-10","2.02e-10","2.09e-10","2.41e-10","2.51e-10","2.53e-10","2.55e-10","2.56e-10","2.60e-10","2.62e-10","2.68e-10","3.06e-10","3.23e-10","3.28e-10","3.33e-10","3.35e-10","3.35e-10","3.44e-10","3.82e-10","4.02e-10","4.04e-10","4.49e-10","4.56e-10","4.77e-10","4.78e-10","4.83e-10","4.90e-10","4.92e-10","5.24e-10","5.33e-10","5.33e-10","5.71e-10","5.78e-10","5.82e-10","6.07e-10","6.20e-10","6.47e-10","6.51e-10","6.63e-10","6.75e-10","6.78e-10","6.79e-10","6.81e-10","7.26e-10","7.56e-10","7.84e-10","7.99e-10","8.03e-10","8.21e-10","8.29e-10","8.35e-10","8.36e-10","8.50e-10","8.57e-10","8.66e-10","8.87e-10","9.18e-10","9.25e-10","9.48e-10","9.59e-10","1.01e-09","1.02e-09","1.04e-09","1.04e-09","1.05e-09","1.06e-09","1.07e-09","1.07e-09","1.11e-09","1.13e-09","1.13e-09","1.14e-09","1.15e-09"],["6.87e-06","6.87e-06","6.87e-06","6.87e-06","6.87e-06","7.25e-06","7.25e-06","7.25e-06","7.25e-06","7.25e-06","7.25e-06","7.25e-06","7.94e-06","7.96e-06","7.96e-06","8.40e-06","9.20e-06","9.66e-06","1.01e-05","1.03e-05","1.03e-05","1.10e-05","1.22e-05","1.29e-05","1.32e-05","1.32e-05","1.32e-05","1.34e-05","1.46e-05","1.46e-05","1.48e-05","1.48e-05","1.48e-05","1.48e-05","1.48e-05","1.48e-05","1.48e-05","1.48e-05","1.60e-05","1.60e-05","1.60e-05","1.60e-05","1.60e-05","1.60e-05","1.60e-05","1.74e-05","1.76e-05","1.76e-05","1.87e-05","1.87e-05","1.87e-05","1.87e-05","1.87e-05","1.87e-05","1.87e-05","1.93e-05","1.93e-05","1.93e-05","2.00e-05","2.00e-05","2.00e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.04e-05","2.14e-05","2.20e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.22e-05","2.24e-05","2.28e-05","2.28e-05","2.31e-05","2.31e-05","2.36e-05","2.36e-05","2.36e-05","2.36e-05","2.36e-05","2.36e-05","2.36e-05","2.36e-05","2.40e-05","2.40e-05","2.40e-05","2.40e-05","2.40e-05"],["1.04e-04","1.04e-04","1.04e-04","1.04e-04","1.04e-04","1.10e-04","1.10e-04","1.10e-04","1.10e-04","1.10e-04","1.10e-04","1.10e-04","1.20e-04","1.20e-04","1.20e-04","1.27e-04","1.39e-04","1.46e-04","1.52e-04","1.55e-04","1.55e-04","1.66e-04","1.85e-04","1.95e-04","2.00e-04","2.00e-04","2.00e-04","2.03e-04","2.21e-04","2.21e-04","2.23e-04","2.23e-04","2.23e-04","2.23e-04","2.23e-04","2.23e-04","2.23e-04","2.23e-04","2.41e-04","2.41e-04","2.41e-04","2.41e-04","2.41e-04","2.41e-04","2.42e-04","2.63e-04","2.67e-04","2.67e-04","2.84e-04","2.84e-04","2.84e-04","2.84e-04","2.84e-04","2.84e-04","2.84e-04","2.92e-04","2.92e-04","2.92e-04","3.03e-04","3.03e-04","3.03e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.09e-04","3.25e-04","3.33e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.35e-04","3.39e-04","3.46e-04","3.46e-04","3.50e-04","3.50e-04","3.58e-04","3.58e-04","3.58e-04","3.58e-04","3.58e-04","3.58e-04","3.58e-04","3.58e-04","3.64e-04","3.64e-04","3.64e-04","3.64e-04","3.64e-04"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 11"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>k11topTable <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 11"</span>) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="k-12-1" class="level2">
<h2 class="anchored" data-anchor-id="k-12-1">k = 12</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topRes</span>(k12topTable,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">cap =</span> <span class="fu">paste</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"The top 100 differentially expressed 12-mers."</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(k12topTable, DE)),</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"of"</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>           <span class="fu">nrow</span>(k12topTable),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"detected sequences were classified as DE with a BY p-value &lt; 0.05."</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cdbb3bc37c0b97e7ff89" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cdbb3bc37c0b97e7ff89">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"logical\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;true&quot;,&quot;false&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>The top 100 differentially expressed 12-mers. 384141 of 8390350 detected sequences were classified as DE with a BY p-value &lt; 0.05.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["CAACGTCGTGGA","CCATGTGGCGTA","CCGTTCCACGAC","CCCCGCTACCAG","GGACGTAGTCCA","CCCGTTCCACGA","CGTGGAACGGGA","GTTGGATAGCAA","AACGTCGTGGAA","AAGCTTGCTATC","CGTCGTGGAACG","AGCCAGAGGCCG","GCTTGCTATCCA","CGTTGGATAGCA","AGCAAGCTTGTC","CCGGCCTCTGGC","CTGGGGAGGTAA","GAGGCCGGGGAC","ACGTTGGATAGC","CCCAGTAATGGC","GAGAGTATAACC","ACAAGCTTGCTA","GGTGTGGACTAC","ATAGCAAGCTTG","ACGACGTTGGAT","CTTGTCCCCGGC","CCTGGCGAGCCG","CAGCCAGAGGCC","AAGTGGTATCGC","CACGACGTTGGA","GCCCGACCGTTA","CGGTCGGGCACA","CATCACGTGCGA","AGCTTGCTATCC","ATTAACGGTCGG","CGACCGTTAATC","ACGGTCGGGCAC","CCAGAGGCCGGG","CTTGTGCCCGAC","AACGGTCGGGCA","CCCGACCGTTAA","CACCCTTCAACC","AATAGCGATACC","GGTTCCTGGCGA","CGAGCCGTGAAA","CCTGTATATTCC","GGTCGGGCACAA","AAGGGCTCTGGG","GCAAGCTTGTCC","ATCACGTGCGAT","ACGTCGTGGAAC","CCAGTAATGGCC","ATAGCGATACCA","CGAGTTAGGAGC","CCATTACTGGGG","ATTTCTGGTAGC","GGCGAGCCGTGA","GGAGTAGACCGA","AGTAATGGCCCA","ACTAGTGATCGG","GTTATACTCTCA","CTCGGAGTAGAC","ACCGTTAATCTC","TAGTCCACACCA","CGCTACCAGAAA","AATATACAGGAC","CGTGAAAACTTA","AATCTCGGTCTA","ATACTCTCAATC","ACACCCGACAAT","CTCGCCAGGAAC","CCGAGATTAACG","CTCCTAACTCGA","CGTCTTCTAGAG","CTTTCCATCTTA","GGGCACAAGCCA","TGTCGTACTGAA","ACGTCCTGTATA","ACAGGACGCAGT","ACCTCCTCTCTA","CGGCCCAGAACA","ATATACAGGACG","GGCCGGGGACAA","AGTCCACACCAG","ACGAATCAAGTC","ACGGCTGAAACC","CCACGCTCCTAA","CGCCAGGAACCA","CCCTGCGGCCCA","GTAAGGGCCCAC","AAGATCGCACGT","CCACTGGTTGAC","ACGCAGTCCACA","AGAACGTTGGAC","TAGAGAAATCCA","CCGCCGGGTACC","GAGGTAAAGCAA","CGTATAGTACTA","ACCGAGATTAAC","CAGGACGCAGTC"],[" -2.09"," -3.11"," -2.09"," -3.09"," -1.96"," -2.10"," -1.76"," -1.09"," -2.12"," -1.13"," -2.12"," -1.16"," -1.18"," -1.20"," -1.05"," -1.22"," -1.62"," -1.07"," -1.20"," -1.59"," -2.20"," -1.21"," -1.73"," -1.13"," -2.01"," -1.21"," -2.47"," -1.01"," -3.02"," -2.08"," -2.30"," -2.24"," -2.57"," -1.20"," -2.29"," -2.28"," -2.30"," -1.02"," -2.29"," -2.30"," -2.29"," -2.64"," -2.99"," -2.61"," -2.41"," -1.15"," -2.29"," -1.47"," -1.07"," -2.58"," -2.15"," -1.56"," -2.96"," -2.87"," -1.54"," -1.12"," -2.47"," -2.21"," -1.51"," -3.78"," -2.16"," -2.17"," -2.19"," -1.67"," -1.02"," -1.04"," -2.43"," -2.18"," -1.96"," -3.11"," -2.61"," -2.08"," -3.02"," -1.92"," -1.58"," -2.25"," -1.22"," -1.83"," -1.92"," -1.84"," -2.16"," -1.06"," -1.22"," -0.74"," -2.75"," -2.46"," -2.81"," -2.51"," -2.71"," -2.17"," -2.68"," -1.67"," -1.90"," -2.30"," -1.79"," -3.47"," -1.12"," -5.90"," -2.10"," -2.03"],["  16.74","  15.71","  16.90","  15.67","  15.28","  17.29","  13.50","  14.68","  17.72","  14.44","  17.79","  14.90","  16.21","  16.91","  13.93","  16.40","  13.50","  13.96","  16.86","  13.87","  14.03","  16.15","  13.32","  14.82","  17.49","  16.84","  11.67","  13.29","  11.64","  17.69","  12.15","  11.27","  11.81","  16.64","  12.10","  11.95","  12.15","  12.78","  11.95","  12.22","  12.07","  11.53","  11.34","  11.48","  11.04","  13.58","  11.94","  12.61","  14.43","  11.67","  18.48","  13.98","  11.17","  11.79","  12.32","  17.41","  11.30","  11.61","  12.48","  14.51","  14.16","  11.43","  11.13","  11.84","  15.31","  13.52","  11.75","  11.14","  11.31","  11.82","  11.75","  10.43","  10.82","  12.24","  15.22","  10.73","  13.58","  12.71","  13.43","  17.78","  13.90","  14.40","  17.01","  12.20","  12.81","  12.42","  11.72","  11.26","  13.11","  17.44","  11.61","  16.83","  12.81","  11.67","  11.98","  15.26","  12.28","  19.12","  10.67","  13.75"],["9.06e-12","9.19e-12","1.02e-11","1.28e-11","1.50e-11","1.67e-11","1.76e-11","2.48e-11","3.03e-11","3.14e-11","3.81e-11","4.11e-11","4.49e-11","4.73e-11","4.87e-11","4.94e-11","5.12e-11","5.67e-11","5.93e-11","6.23e-11","6.26e-11","6.34e-11","6.65e-11","6.86e-11","6.87e-11","6.90e-11","7.02e-11","7.61e-11","8.55e-11","8.63e-11","9.09e-11","9.38e-11","9.73e-11","9.74e-11","9.97e-11","1.01e-10","1.01e-10","1.04e-10","1.05e-10","1.05e-10","1.05e-10","1.07e-10","1.09e-10","1.09e-10","1.12e-10","1.12e-10","1.12e-10","1.13e-10","1.14e-10","1.23e-10","1.29e-10","1.32e-10","1.33e-10","1.33e-10","1.40e-10","1.45e-10","1.48e-10","1.49e-10","1.50e-10","1.53e-10","1.54e-10","1.55e-10","1.59e-10","1.59e-10","1.60e-10","1.60e-10","1.61e-10","1.63e-10","1.66e-10","1.69e-10","1.77e-10","1.80e-10","1.83e-10","1.84e-10","1.85e-10","1.88e-10","1.88e-10","1.89e-10","1.91e-10","1.94e-10","2.06e-10","2.11e-10","2.11e-10","2.13e-10","2.15e-10","2.16e-10","2.19e-10","2.21e-10","2.26e-10","2.30e-10","2.34e-10","2.36e-10","2.37e-10","2.40e-10","2.42e-10","2.46e-10","2.46e-10","2.48e-10","2.50e-10","2.51e-10"],["1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","1.95e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.01e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05","2.02e-05"],["3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.21e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.33e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04","3.34e-04"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"striped hover condensed responsive\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mer<\/th>\n      <th>logCPM<\/th>\n      <th>logFC<\/th>\n      <th>P.Value<\/th>\n      <th>FDR<\/th>\n      <th>BY<\/th>\n      <th>DE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"mer","targets":1},{"name":"logCPM","targets":2},{"name":"logFC","targets":3},{"name":"P.Value","targets":4},{"name":"FDR","targets":5},{"name":"BY","targets":6},{"name":"DE","targets":7}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(P.Value)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">binwidth =</span> <span class="fl">0.02</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"k = 12"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Histogram of p-values. Values follow the expected distribution when there are many differences.</em></figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>k12topTable <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(logFC, <span class="sc">-</span><span class="fu">log10</span>(P.Value), <span class="at">colour =</span> DE)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">-</span><span class="fu">log10</span>(P.Value) <span class="sc">&gt;</span> <span class="fl">8.5</span> <span class="sc">|</span> logFC <span class="sc">&gt;</span> <span class="dv">20</span> <span class="sc">|</span> logFC <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">13.5</span>),</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">label =</span> mer, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"logFC"</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="sc">-</span>log[<span class="dv">10</span>], <span class="st">"(p)"</span>)), <span class="at">title =</span> <span class="st">"k = 11"</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kmer_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption><em>Volcano plot showing -log10(p-value) against logFC. Kmers classified as DE with BY p-value &lt; 0.05 are highlighted in red.</em></figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data-export" class="level1">
<h1>Data export</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k5counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k5counts.Rds"</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k6counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k6counts.Rds"</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k7counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k7counts.Rds"</span>))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k8counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k8counts.Rds"</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k9counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k9counts.Rds"</span>))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k10counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k10counts.Rds"</span>))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k11counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k11counts.Rds"</span>))</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k12counts, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k12counts.Rds"</span>))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k5topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k5topTable.Rds"</span>))</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k6topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k6topTable.Rds"</span>))</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k7topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k7topTable.Rds"</span>))</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k8topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k8topTable.Rds"</span>))</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k9topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k9topTable.Rds"</span>))</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k10topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k10topTable.Rds"</span>))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k11topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k11topTable.Rds"</span>))</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(k12topTable, <span class="fu">here</span>(<span class="st">"1_Psen2S4Ter/Rdata/k12topTable.Rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level1">
<h1>Session info</h1>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Australia/Adelaide
tzcode source: system (glibc)

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] ggdendro_0.2.0   pheatmap_1.0.12  ggrepel_0.9.6    DT_0.33         
 [5] edgeR_4.4.0      limma_3.62.1     kableExtra_1.4.0 ggpubr_0.6.0    
 [9] scales_1.3.0     here_1.0.1       pander_0.6.5     magrittr_2.0.3  
[13] lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     
[17] purrr_1.0.2      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    
[21] ggplot2_3.5.1    tidyverse_2.0.0 

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1   viridisLite_0.4.2  farver_2.1.2       fastmap_1.2.0     
 [5] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    statmod_1.5.0     
 [9] compiler_4.4.2     sass_0.4.9         rlang_1.1.4        tools_4.4.2       
[13] utf8_1.2.4         yaml_2.3.10        knitr_1.49         ggsignif_0.6.4    
[17] labeling_0.4.3     htmlwidgets_1.6.4  bit_4.5.0          xml2_1.3.6        
[21] RColorBrewer_1.1-3 abind_1.4-8        withr_3.0.2        grid_4.4.2        
[25] fansi_1.0.6        colorspace_2.1-1   MASS_7.3-61        cli_3.6.3         
[29] rmarkdown_2.28     crayon_1.5.3       generics_0.1.3     rstudioapi_0.17.1 
[33] tzdb_0.4.0         cachem_1.1.0       splines_4.4.2      vctrs_0.6.5       
[37] Matrix_1.7-1       jsonlite_1.8.9     carData_3.0-5      car_3.1-2         
[41] hms_1.1.3          bit64_4.5.2        rstatix_0.7.2      systemfonts_1.1.0 
[45] crosstalk_1.2.1    locfit_1.5-9.10    jquerylib_0.1.4    glue_1.8.0        
[49] cowplot_1.1.3      stringi_1.8.4      gtable_0.3.6       munsell_0.5.1     
[53] pillar_1.9.0       htmltools_0.5.8.1  R6_2.5.1           rprojroot_2.0.4   
[57] vroom_1.6.5        evaluate_1.0.1     lattice_0.22-6     backports_1.5.0   
[61] broom_1.0.7        bslib_0.8.0        Rcpp_1.0.13-1      svglite_2.1.3     
[65] gridExtra_2.3      nlme_3.1-166       mgcv_1.9-1         xfun_0.49         
[69] pkgconfig_2.0.3   </code></pre>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>